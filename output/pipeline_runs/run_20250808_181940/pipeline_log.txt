

============================================================
Module: EDA Analysis
Start: 2025-08-08 18:19:40.180924
============================================================
Starting EDA analysis on subdataset_1000...
Output directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/1_eda

Found 14 data files
Using chunk size: 200,000 rows

Analyzing tables...

Processing tables:   0%|          | 0/14 [00:00<?, ?table/s]

Reading CONDITION_ERA:   0%|          | 0/53464 [00:00<?, ?rows/s][A

                                                                  [A

Reading CONDITION_OCCURRENCE:   0%|          | 0/196241 [00:00<?, ?rows/s][A

Reading CONDITION_OCCURRENCE: 100%|██████████| 196241/196241 [00:00<00:00, 597975.26rows/s][A

                                                                                           [A
Processing tables:  14%|█▍        | 2/14 [00:00<00:03,  3.92table/s]

Reading DEATH:   0%|          | 0/113 [00:00<?, ?rows/s][A

                                                        [A

Reading DEVICE_EXPOSURE:   0%|          | 0/6338 [00:00<?, ?rows/s][A

                                                                   [A

Reading DRUG_ERA:   0%|          | 0/34017 [00:00<?, ?rows/s][A

                                                             [A

Reading DRUG_EXPOSURE:   0%|          | 0/204252 [00:00<?, ?rows/s][A

Reading DRUG_EXPOSURE:  98%|█████████▊| 200000/204252 [00:00<00:00, 397725.15rows/s][A

                                                                                    [A
Processing tables:  43%|████▎     | 6/14 [00:01<00:01,  4.91table/s]

Reading MEASUREMENT:   0%|          | 0/1944155 [00:00<?, ?rows/s][A

Reading MEASUREMENT:  10%|█         | 200000/1944155 [00:00<00:05, 316875.77rows/s][A

Reading MEASUREMENT:  21%|██        | 400000/1944155 [00:00<00:03, 426987.42rows/s][A

Reading MEASUREMENT:  31%|███       | 600000/1944155 [00:01<00:02, 448358.14rows/s][A

Reading MEASUREMENT:  41%|████      | 800000/1944155 [00:01<00:02, 404692.90rows/s][A

Reading MEASUREMENT:  51%|█████▏    | 1000000/1944155 [00:02<00:02, 419203.64rows/s][A

Reading MEASUREMENT:  62%|██████▏   | 1200000/1944155 [00:02<00:01, 474067.32rows/s][A

Reading MEASUREMENT:  72%|███████▏  | 1400000/1944155 [00:03<00:01, 484158.27rows/s][A

Reading MEASUREMENT:  82%|████████▏ | 1600000/1944155 [00:03<00:00, 507961.99rows/s][A

Reading MEASUREMENT:  93%|█████████▎| 1800000/1944155 [00:03<00:00, 513362.01rows/s][A

Reading MEASUREMENT: 100%|██████████| 1944155/1944155 [00:04<00:00, 528613.87rows/s][A

                                                                                    [A
Processing tables:  50%|█████     | 7/14 [00:06<00:09,  1.29s/table]

Reading OBSERVATION:   0%|          | 0/241604 [00:00<?, ?rows/s][A

Reading OBSERVATION:  83%|████████▎ | 200000/241604 [00:00<00:00, 782576.34rows/s][A

                                                                                  [A
Processing tables:  57%|█████▋    | 8/14 [00:07<00:06,  1.09s/table]

Reading OBSERVATION_PERIOD:   0%|          | 0/364 [00:00<?, ?rows/s][A

                                                                     [A

Reading PERSON:   0%|          | 0/538 [00:00<?, ?rows/s][A

                                                         [A

Reading PROCEDURE_OCCURRENCE:   0%|          | 0/47395 [00:00<?, ?rows/s][A

                                                                         [A
Processing tables:  79%|███████▊  | 11/14 [00:07<00:01,  1.77table/s]

Reading SPECIMEN:   0%|          | 0/3944 [00:00<?, ?rows/s][A

                                                            [A

Reading VISIT_DETAIL:   0%|          | 0/40437 [00:00<?, ?rows/s][A

                                                                 [A
Processing tables:  93%|█████████▎| 13/14 [00:07<00:00,  2.48table/s]

Reading VISIT_OCCURRENCE:   0%|          | 0/55185 [00:00<?, ?rows/s][A

                                                                     [A
Processing tables: 100%|██████████| 14/14 [00:07<00:00,  1.89table/s]

============================================================
OVERALL SUMMARY
============================================================
Total records across all tables: 2,828,047
Total tables analyzed: 14

Patient Statistics:
  - Total patients: 538

ICU Statistics:
  - Total ICU visits: 1,259
  - Unique ICU patients: 413

Mortality Statistics:
  - Total deaths: 113
  - Death rate: 21.0%

Detailed results saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/1_eda/eda_results.json

Generating visualizations...
EDA analysis completed!
Report saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/1_eda/eda_report.md


============================================================
Module: Data Cleaning
Start: 2025-08-08 18:19:50.849303
============================================================
Starting data cleaning on subdataset_1000...
Output directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning
Chunk size: 100,000 rows
Tables to clean: MEASUREMENT, OBSERVATION, DRUG_EXPOSURE, CONDITION_OCCURRENCE, VISIT_OCCURRENCE, PROCEDURE_OCCURRENCE, VISIT_DETAIL, CONDITION_ERA, SPECIMEN, DEATH, DEVICE_EXPOSURE, DRUG_ERA, OBSERVATION_PERIOD, PERSON

======================================================================
DATA CLEANING PROCESS - INPUT INFORMATION
======================================================================
Data Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data
Output Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning

Tables to be cleaned:
  - MEASUREMENT: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/MEASUREMENT.csv
  - OBSERVATION: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/OBSERVATION.csv
  - DRUG_EXPOSURE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/DRUG_EXPOSURE.csv
  - CONDITION_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/CONDITION_OCCURRENCE.csv
  - VISIT_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/VISIT_OCCURRENCE.csv
  - PROCEDURE_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/PROCEDURE_OCCURRENCE.csv
  - VISIT_DETAIL: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/VISIT_DETAIL.csv
  - CONDITION_ERA: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/CONDITION_ERA.csv
  - SPECIMEN: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/SPECIMEN.csv
  - DEATH: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/DEATH.csv
  - DEVICE_EXPOSURE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/DEVICE_EXPOSURE.csv
  - DRUG_ERA: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/DRUG_ERA.csv
  - OBSERVATION_PERIOD: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/OBSERVATION_PERIOD.csv
  - PERSON: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/data/PERSON.csv

Cleaning Strategy:
  1. Remove columns with >95% missing data
  2. Remove duplicate records based on table-specific keys
  3. Remove records with invalid concept IDs (0 or null)
  4. Validate temporal consistency for date ranges
======================================================================


Starting table cleaning process...

Processing tables:   0%|          | 0/14 [00:00<?, ?table/s]
[1/14] Processing MEASUREMENT...

============================================================
Cleaning MEASUREMENT
============================================================
Counting rows...
Total records: 1,944,155

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 3
  - measurement_source_value: 100.0% missing
  - unit_source_value: 100.0% missing
  - value_source_value: 100.0% missing

Processing data in chunks...


Cleaning MEASUREMENT:   0%|          | 0/1944155 [00:00<?, ?rows/s][A

Cleaning MEASUREMENT:   5%|▌         | 100000/1944155 [00:01<00:23, 77899.63rows/s][A

Cleaning MEASUREMENT:  10%|█         | 200000/1944155 [00:02<00:23, 75451.96rows/s][A

Cleaning MEASUREMENT:  15%|█▌        | 300000/1944155 [00:04<00:23, 68922.26rows/s][A

Cleaning MEASUREMENT:  21%|██        | 400000/1944155 [00:05<00:23, 65833.40rows/s][A

Cleaning MEASUREMENT:  26%|██▌       | 500000/1944155 [00:08<00:27, 53061.87rows/s][A

Cleaning MEASUREMENT:  31%|███       | 600000/1944155 [00:10<00:24, 55440.32rows/s][A

Cleaning MEASUREMENT:  36%|███▌      | 700000/1944155 [00:12<00:23, 52783.81rows/s][A

Cleaning MEASUREMENT:  41%|████      | 800000/1944155 [00:14<00:23, 47975.40rows/s][A

Cleaning MEASUREMENT:  46%|████▋     | 900000/1944155 [00:15<00:18, 56837.81rows/s][A

Cleaning MEASUREMENT:  51%|█████▏    | 1000000/1944155 [00:17<00:16, 57911.34rows/s][A

Cleaning MEASUREMENT:  57%|█████▋    | 1100000/1944155 [00:18<00:12, 70319.69rows/s][A

Cleaning MEASUREMENT:  62%|██████▏   | 1200000/1944155 [00:19<00:11, 63504.12rows/s][A

Cleaning MEASUREMENT:  67%|██████▋   | 1300000/1944155 [00:20<00:08, 73525.40rows/s][A

Cleaning MEASUREMENT:  72%|███████▏  | 1400000/1944155 [00:24<00:10, 50393.03rows/s][A

Cleaning MEASUREMENT:  77%|███████▋  | 1500000/1944155 [00:25<00:07, 57249.56rows/s][A

Cleaning MEASUREMENT:  82%|████████▏ | 1600000/1944155 [00:28<00:07, 46706.96rows/s][A

Cleaning MEASUREMENT:  87%|████████▋ | 1700000/1944155 [00:30<00:04, 49423.89rows/s][A

Cleaning MEASUREMENT:  93%|█████████▎| 1800000/1944155 [00:34<00:03, 36265.18rows/s][A

Cleaning MEASUREMENT:  98%|█████████▊| 1900000/1944155 [00:37<00:01, 36577.75rows/s][A

Cleaning MEASUREMENT: 100%|██████████| 1944155/1944155 [00:38<00:00, 37780.24rows/s][A
Cleaning MEASUREMENT: 100%|██████████| 1944155/1944155 [00:38<00:00, 50657.69rows/s]

Processing tables:   7%|▋         | 1/14 [01:02<13:35, 62.71s/table]
Writing duplicate groups...
Duplicate groups written: 497365 records in 127274 groups

Calculating outlier statistics...
Outlier detection (IQR method):
  - value_as_number: 22,900 outliers (1.6%)

Duplicates found and removed: 370,091
Invalid measurement_concept_id records removed: 13,231

Cleaning Summary:
  - Original records: 1,944,155
  - Cleaned records: 1,560,833
  - Records removed: 383,322 (19.7%)
  - Original columns: 20
  - Cleaned columns: 17
  - Columns removed: 3

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/MEASUREMENT_cleaned.csv

[2/14] Processing OBSERVATION...

============================================================
Cleaning OBSERVATION
============================================================
Counting rows...
Total records: 241,604

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 5
  - value_as_string: 100.0% missing
  - unit_concept_id: 97.4% missing
  - observation_source_value: 100.0% missing
  - unit_source_value: 100.0% missing
  - qualifier_source_value: 100.0% missing

Processing data in chunks...


Cleaning OBSERVATION:   0%|          | 0/241604 [00:00<?, ?rows/s][A

Cleaning OBSERVATION:  41%|████▏     | 100000/241604 [00:01<00:01, 86084.29rows/s][A

Cleaning OBSERVATION:  83%|████████▎ | 200000/241604 [00:02<00:00, 82220.52rows/s][A

Cleaning OBSERVATION: 100%|██████████| 241604/241604 [00:03<00:00, 74528.04rows/s][A
Cleaning OBSERVATION: 100%|██████████| 241604/241604 [00:03<00:00, 77223.95rows/s]

Processing tables:  14%|█▍        | 2/14 [01:07<05:45, 28.81s/table]
Writing duplicate groups...
Duplicate groups written: 55306 records in 19786 groups

Duplicates found and removed: 35,520
Invalid observation_concept_id records removed: 1,251

Cleaning Summary:
  - Original records: 241,604
  - Cleaned records: 204,833
  - Records removed: 36,771 (15.2%)
  - Original columns: 18
  - Cleaned columns: 13
  - Columns removed: 5

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/OBSERVATION_cleaned.csv

[3/14] Processing DRUG_EXPOSURE...

============================================================
Cleaning DRUG_EXPOSURE
============================================================
Counting rows...
Total records: 204,252

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 6
  - stop_reason: 100.0% missing
  - sig: 100.0% missing
  - lot_number: 100.0% missing
  - drug_source_value: 100.0% missing
  - route_source_value: 100.0% missing
  ... and 1 more columns

Processing data in chunks...


Cleaning DRUG_EXPOSURE:   0%|          | 0/204252 [00:00<?, ?rows/s][A

Cleaning DRUG_EXPOSURE:  49%|████▉     | 100000/204252 [00:01<00:01, 63400.45rows/s][A

Cleaning DRUG_EXPOSURE:  98%|█████████▊| 200000/204252 [00:03<00:00, 59711.52rows/s][A
Cleaning DRUG_EXPOSURE: 100%|██████████| 204252/204252 [00:03<00:00, 60255.11rows/s]

Processing tables:  21%|██▏       | 3/14 [01:13<03:19, 18.12s/table]
Writing duplicate groups...
Duplicate groups written: 22741 records in 10368 groups

Duplicates found and removed: 12,373
Invalid drug_concept_id records removed: 9,016
Temporal inconsistencies found and removed: 338

Cleaning Summary:
  - Original records: 204,252
  - Cleaned records: 182,525
  - Records removed: 21,727 (10.6%)
  - Original columns: 23
  - Cleaned columns: 17
  - Columns removed: 6

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DRUG_EXPOSURE_cleaned.csv

[4/14] Processing CONDITION_OCCURRENCE...

============================================================
Cleaning CONDITION_OCCURRENCE
============================================================
Counting rows...
Total records: 196,241

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 3
  - stop_reason: 99.3% missing
  - condition_source_value: 100.0% missing
  - condition_status_source_value: 100.0% missing

Processing data in chunks...


Cleaning CONDITION_OCCURRENCE:   0%|          | 0/196241 [00:00<?, ?rows/s][A

Cleaning CONDITION_OCCURRENCE:  51%|█████     | 100000/196241 [00:01<00:01, 81563.29rows/s][A

Cleaning CONDITION_OCCURRENCE: 100%|██████████| 196241/196241 [00:02<00:00, 84937.74rows/s][A
Cleaning CONDITION_OCCURRENCE: 100%|██████████| 196241/196241 [00:02<00:00, 84226.76rows/s]

Processing tables:  29%|██▊       | 4/14 [01:17<02:06, 12.66s/table]
Writing duplicate groups...
Duplicate groups written: 102896 records in 39532 groups

Duplicates found and removed: 63,364
Invalid condition_concept_id records removed: 321

Cleaning Summary:
  - Original records: 196,241
  - Cleaned records: 132,556
  - Records removed: 63,685 (32.5%)
  - Original columns: 16
  - Cleaned columns: 13
  - Columns removed: 3

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/CONDITION_OCCURRENCE_cleaned.csv

[5/14] Processing VISIT_OCCURRENCE...

============================================================
Cleaning VISIT_OCCURRENCE
============================================================
Counting rows...
Total records: 55,185

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 3
  - visit_source_value: 100.0% missing
  - admitting_source_value: 100.0% missing
  - discharge_to_source_value: 100.0% missing

Processing data in chunks...


Cleaning VISIT_OCCURRENCE:   0%|          | 0/55185 [00:00<?, ?rows/s][A

Cleaning VISIT_OCCURRENCE: 100%|██████████| 55185/55185 [00:00<00:00, 99642.68rows/s][A
Cleaning VISIT_OCCURRENCE: 100%|██████████| 55185/55185 [00:00<00:00, 99202.42rows/s]

Processing tables:  36%|███▌      | 5/14 [01:18<01:16,  8.49s/table]
Writing duplicate groups...
Duplicate groups written: 18296 records in 7128 groups

Duplicates found and removed: 11,168
Invalid visit_concept_id records removed: 18,572
Temporal inconsistencies found and removed: 20

Cleaning Summary:
  - Original records: 55,185
  - Cleaned records: 25,425
  - Records removed: 29,760 (53.9%)
  - Original columns: 17
  - Cleaned columns: 14
  - Columns removed: 3

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_OCCURRENCE_cleaned.csv

[6/14] Processing PROCEDURE_OCCURRENCE...

============================================================
Cleaning PROCEDURE_OCCURRENCE
============================================================
Counting rows...
Total records: 47,395

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 2
  - procedure_source_value: 100.0% missing
  - modifier_source_value: 100.0% missing

Processing data in chunks...


Cleaning PROCEDURE_OCCURRENCE:   0%|          | 0/47395 [00:00<?, ?rows/s][A

Cleaning PROCEDURE_OCCURRENCE: 100%|██████████| 47395/47395 [00:00<00:00, 82697.79rows/s][A
Cleaning PROCEDURE_OCCURRENCE: 100%|██████████| 47395/47395 [00:00<00:00, 82270.87rows/s]

Processing tables:  43%|████▎     | 6/14 [01:19<00:47,  5.95s/table]
Writing duplicate groups...
Duplicate groups written: 2360 records in 1135 groups

Duplicates found and removed: 1,225
Invalid procedure_concept_id records removed: 103

Cleaning Summary:
  - Original records: 47,395
  - Cleaned records: 46,067
  - Records removed: 1,328 (2.8%)
  - Original columns: 14
  - Cleaned columns: 12
  - Columns removed: 2

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/PROCEDURE_OCCURRENCE_cleaned.csv

[7/14] Processing VISIT_DETAIL...

============================================================
Cleaning VISIT_DETAIL
============================================================
Counting rows...
Total records: 40,437

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 5
  - visit_detail_source_value: 100.0% missing
  - admitting_source_value: 100.0% missing
  - discharge_to_source_value: 100.0% missing
  - discharge_to_concept_id: 100.0% missing
  - visit_detail_parent_id: 100.0% missing

Processing data in chunks...


Cleaning VISIT_DETAIL:   0%|          | 0/40437 [00:00<?, ?rows/s][A

Cleaning VISIT_DETAIL: 100%|██████████| 40437/40437 [00:00<00:00, 82351.55rows/s][A
Cleaning VISIT_DETAIL: 100%|██████████| 40437/40437 [00:00<00:00, 82026.95rows/s]

Processing tables:  50%|█████     | 7/14 [01:20<00:30,  4.35s/table]
Writing duplicate groups...
Duplicate groups written: 20142 records in 7175 groups

Duplicates found and removed: 12,967
Invalid visit_detail_concept_id records removed: 235
Temporal inconsistencies found and removed: 257

Cleaning Summary:
  - Original records: 40,437
  - Cleaned records: 26,978
  - Records removed: 13,459 (33.3%)
  - Original columns: 19
  - Cleaned columns: 14
  - Columns removed: 5

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_DETAIL_cleaned.csv

[8/14] Processing CONDITION_ERA...

============================================================
Cleaning CONDITION_ERA
============================================================
Counting rows...
Total records: 53,464

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 0

Processing data in chunks...


Cleaning CONDITION_ERA:   0%|          | 0/53464 [00:00<?, ?rows/s][A

Cleaning CONDITION_ERA: 100%|██████████| 53464/53464 [00:00<00:00, 166033.69rows/s][A
Cleaning CONDITION_ERA: 100%|██████████| 53464/53464 [00:00<00:00, 161318.46rows/s]

Processing tables:  57%|█████▋    | 8/14 [01:21<00:18,  3.15s/table]
Writing duplicate groups...
Duplicate groups written: 0 records in 0 groups

Duplicates found and removed: 0
Invalid condition_concept_id records removed: 194

Cleaning Summary:
  - Original records: 53,464
  - Cleaned records: 53,270
  - Records removed: 194 (0.4%)
  - Original columns: 6
  - Cleaned columns: 6
  - Columns removed: 0

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/CONDITION_ERA_cleaned.csv

[9/14] Processing SPECIMEN...

============================================================
Cleaning SPECIMEN
============================================================
Counting rows...
Total records: 3,944

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 6
  - disease_status_concept_id: 98.3% missing
  - specimen_source_id: 100.0% missing
  - specimen_source_value: 100.0% missing
  - unit_source_value: 100.0% missing
  - anatomic_site_source_value: 100.0% missing
  ... and 1 more columns

Processing data in chunks...


Cleaning SPECIMEN:   0%|          | 0/3944 [00:00<?, ?rows/s][A
Cleaning SPECIMEN: 100%|██████████| 3944/3944 [00:00<00:00, 111950.29rows/s]

Writing duplicate groups...
Duplicate groups written: 0 records in 0 groups

Duplicates found and removed: 0
Invalid specimen_concept_id records removed: 70

Cleaning Summary:
  - Original records: 3,944
  - Cleaned records: 3,874
  - Records removed: 70 (1.8%)
  - Original columns: 15
  - Cleaned columns: 9
  - Columns removed: 6

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/SPECIMEN_cleaned.csv

[10/14] Processing DEATH...

============================================================
Cleaning DEATH
============================================================
Counting rows...
Total records: 113

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 1
  - cause_source_value: 100.0% missing

Processing data in chunks...


Cleaning DEATH:   0%|          | 0/113 [00:00<?, ?rows/s][A
Cleaning DEATH: 100%|██████████| 113/113 [00:00<00:00, 116479.81rows/s]

Writing duplicate groups...
Duplicate groups written: 0 records in 0 groups

Duplicates found and removed: 0
Invalid death_type_concept_id records removed: 1

Cleaning Summary:
  - Original records: 113
  - Cleaned records: 112
  - Records removed: 1 (0.9%)
  - Original columns: 7
  - Cleaned columns: 6
  - Columns removed: 1

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DEATH_cleaned.csv

[11/14] Processing DEVICE_EXPOSURE...

============================================================
Cleaning DEVICE_EXPOSURE
============================================================
Counting rows...
Total records: 6,338

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 3
  - device_exposure_end_date: 98.8% missing
  - device_exposure_end_datetime: 98.8% missing
  - device_source_value: 100.0% missing

Processing data in chunks...


Cleaning DEVICE_EXPOSURE:   0%|          | 0/6338 [00:00<?, ?rows/s][A
Cleaning DEVICE_EXPOSURE: 100%|██████████| 6338/6338 [00:00<00:00, 83506.62rows/s]

Processing tables:  79%|███████▊  | 11/14 [01:21<00:04,  1.37s/table]
Writing duplicate groups...
Duplicate groups written: 792 records in 368 groups

Duplicates found and removed: 424
Invalid device_concept_id records removed: 0

Cleaning Summary:
  - Original records: 6,338
  - Cleaned records: 5,914
  - Records removed: 424 (6.7%)
  - Original columns: 15
  - Cleaned columns: 12
  - Columns removed: 3

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DEVICE_EXPOSURE_cleaned.csv

[12/14] Processing DRUG_ERA...

============================================================
Cleaning DRUG_ERA
============================================================
Counting rows...
Total records: 34,017

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 0

Processing data in chunks...


Cleaning DRUG_ERA:   0%|          | 0/34017 [00:00<?, ?rows/s][A

Cleaning DRUG_ERA: 100%|██████████| 34017/34017 [00:00<00:00, 138706.20rows/s][A
Cleaning DRUG_ERA: 100%|██████████| 34017/34017 [00:00<00:00, 138049.80rows/s]

Processing tables:  86%|████████▌ | 12/14 [01:21<00:02,  1.17s/table]
Writing duplicate groups...
Duplicate groups written: 5259 records in 2577 groups

Duplicates found and removed: 2,682
Invalid drug_concept_id records removed: 0

Cleaning Summary:
  - Original records: 34,017
  - Cleaned records: 31,335
  - Records removed: 2,682 (7.9%)
  - Original columns: 7
  - Cleaned columns: 7
  - Columns removed: 0

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DRUG_ERA_cleaned.csv

[13/14] Processing OBSERVATION_PERIOD...

============================================================
Cleaning OBSERVATION_PERIOD
============================================================
Counting rows...
Total records: 364

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 0

Processing data in chunks...


Cleaning OBSERVATION_PERIOD:   0%|          | 0/364 [00:00<?, ?rows/s][A
Cleaning OBSERVATION_PERIOD: 100%|██████████| 364/364 [00:00<00:00, 163303.74rows/s]

Writing duplicate groups...
Duplicate groups written: 0 records in 0 groups

Duplicates found and removed: 0
Invalid period_type_concept_id records removed: 0

Cleaning Summary:
  - Original records: 364
  - Cleaned records: 364
  - Records removed: 0 (0.0%)
  - Original columns: 5
  - Cleaned columns: 5
  - Columns removed: 0

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/OBSERVATION_PERIOD_cleaned.csv

[14/14] Processing PERSON...

============================================================
Cleaning PERSON
============================================================
Counting rows...
Total records: 538

Analyzing columns for missing data...

Columns with >95% missing data (will be removed): 4
  - person_source_value: 100.0% missing
  - gender_source_value: 100.0% missing
  - race_source_value: 100.0% missing
  - ethnicity_source_value: 100.0% missing

Processing data in chunks...


Cleaning PERSON:   0%|          | 0/538 [00:00<?, ?rows/s][A
Cleaning PERSON: 100%|██████████| 538/538 [00:00<00:00, 105692.53rows/s]

Processing tables: 100%|██████████| 14/14 [01:21<00:00,  5.85s/table]

Writing duplicate groups...
Duplicate groups written: 0 records in 0 groups

Duplicates found and removed: 0

Cleaning Summary:
  - Original records: 538
  - Cleaned records: 538
  - Records removed: 0 (0.0%)
  - Original columns: 18
  - Cleaned columns: 14
  - Columns removed: 4

Cleaned data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/PERSON_cleaned.csv

============================================================
CLEANING COMPLETE
============================================================
Detailed results saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/cleaning_results.json
Removed columns analysis saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/removed_columns_analysis.csv
Report saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/cleaning_report.md

======================================================================
DATA CLEANING PROCESS - SUMMARY
======================================================================

Tables Processed:
  - Successfully processed: 14
  - Failed with errors: 0

Total Records:
  - Input: 2,828,047
  - Output: 2,274,624
  - Removed: 553,423 (19.6%)

Breakdown of Removals:
  - Duplicate records: 509,814
  - Invalid concept IDs: 42,994
  - Temporal issues: 615
  - Columns removed: 41

Output Files Created:
  Cleaned Data:
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/MEASUREMENT_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/OBSERVATION_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DRUG_EXPOSURE_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/CONDITION_OCCURRENCE_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_OCCURRENCE_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/PROCEDURE_OCCURRENCE_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_DETAIL_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/CONDITION_ERA_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/SPECIMEN_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DEATH_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DEVICE_EXPOSURE_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DRUG_ERA_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/OBSERVATION_PERIOD_cleaned.csv
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/PERSON_cleaned.csv

  Removed Records:
    Duplicates:
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/MEASUREMENT.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/OBSERVATION.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/DRUG_EXPOSURE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/CONDITION_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/VISIT_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/PROCEDURE_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/VISIT_DETAIL.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/CONDITION_ERA.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/SPECIMEN.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/DEATH.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/DEVICE_EXPOSURE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/DRUG_ERA.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/OBSERVATION_PERIOD.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/duplicates/PERSON.csv
    Invalid Concept IDs:
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/MEASUREMENT.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/OBSERVATION.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/DRUG_EXPOSURE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/CONDITION_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/VISIT_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/PROCEDURE_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/VISIT_DETAIL.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/CONDITION_ERA.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/SPECIMEN.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/DEATH.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/DEVICE_EXPOSURE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/DRUG_ERA.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/OBSERVATION_PERIOD.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/invalid_concept_id/PERSON.csv
    Temporal Issues:
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/MEASUREMENT.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/OBSERVATION.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/DRUG_EXPOSURE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/CONDITION_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/VISIT_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/PROCEDURE_OCCURRENCE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/VISIT_DETAIL.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/CONDITION_ERA.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/SPECIMEN.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/DEATH.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/DEVICE_EXPOSURE.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/DRUG_ERA.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/OBSERVATION_PERIOD.csv
      - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/temporal_issues/PERSON.csv

  Reports:
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/cleaning_results.json
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/cleaning_report.md
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/removed_records/removed_columns_analysis.csv
======================================================================


============================================================
Module: Concept Mapping
Start: 2025-08-08 18:21:12.838027
============================================================
2025-08-08 18:21:13,114 - INFO - ============================================================
2025-08-08 18:21:13,114 - INFO - Counting concept frequencies across all tables...
2025-08-08 18:21:13,114 - INFO - 
Processing MEASUREMENT...
2025-08-08 18:21:18,898 - INFO -   Found 2918 unique concepts
2025-08-08 18:21:18,900 - INFO -   Low frequency (≤10): 1818
2025-08-08 18:21:18,900 - INFO -   High frequency (>10): 1100
2025-08-08 18:21:18,900 - INFO - 
Processing OBSERVATION...
2025-08-08 18:21:19,579 - INFO -   Found 837 unique concepts
2025-08-08 18:21:19,579 - INFO -   Low frequency (≤10): 522
2025-08-08 18:21:19,580 - INFO -   High frequency (>10): 315
2025-08-08 18:21:19,580 - INFO - 
Processing PROCEDURE_OCCURRENCE...
2025-08-08 18:21:19,726 - INFO -   Found 3346 unique concepts
2025-08-08 18:21:19,726 - INFO -   Low frequency (≤10): 2806
2025-08-08 18:21:19,726 - INFO -   High frequency (>10): 540
2025-08-08 18:21:19,726 - INFO - 
Processing DEVICE_EXPOSURE...
2025-08-08 18:21:19,745 - INFO -   Found 72 unique concepts
2025-08-08 18:21:19,745 - INFO -   Low frequency (≤10): 50
2025-08-08 18:21:19,745 - INFO -   High frequency (>10): 22
2025-08-08 18:21:19,745 - INFO - 
Processing CONDITION_OCCURRENCE...
2025-08-08 18:21:20,185 - INFO -   Found 6276 unique concepts
2025-08-08 18:21:20,186 - INFO -   Low frequency (≤10): 4546
2025-08-08 18:21:20,186 - INFO -   High frequency (>10): 1730
2025-08-08 18:21:20,186 - INFO - 
Processing CONDITION_ERA...
2025-08-08 18:21:20,297 - INFO -   Found 5484 unique concepts
2025-08-08 18:21:20,297 - INFO -   Low frequency (≤10): 4424
2025-08-08 18:21:20,297 - INFO -   High frequency (>10): 1060
2025-08-08 18:21:20,297 - INFO - 
Processing DRUG_EXPOSURE...
2025-08-08 18:21:21,020 - INFO -   Found 4383 unique concepts
2025-08-08 18:21:21,021 - INFO -   Low frequency (≤10): 3000
2025-08-08 18:21:21,021 - INFO -   High frequency (>10): 1383
2025-08-08 18:21:21,021 - INFO - 
Processing DRUG_ERA...
2025-08-08 18:21:21,089 - INFO -   Found 975 unique concepts
2025-08-08 18:21:21,090 - INFO -   Low frequency (≤10): 569
2025-08-08 18:21:21,090 - INFO -   High frequency (>10): 406
2025-08-08 18:21:21,090 - INFO - 
Processing VISIT_OCCURRENCE...
2025-08-08 18:21:21,182 - INFO -   Found 23 unique concepts
2025-08-08 18:21:21,182 - INFO -   Low frequency (≤10): 9
2025-08-08 18:21:21,182 - INFO -   High frequency (>10): 14
2025-08-08 18:21:21,182 - INFO - 
============================================================
2025-08-08 18:21:21,182 - INFO - Processing MEASUREMENT
2025-08-08 18:21:21,182 - INFO - ============================================================
2025-08-08 18:21:27,466 - INFO - Loaded 1,560,833 rows
2025-08-08 18:21:27,466 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:21:29,516 - INFO -   Removed 7645 low frequency records
2025-08-08 18:21:29,516 - INFO - 
Standardizing dates...
2025-08-08 18:22:04,000 - INFO - Loaded 2346 mappings for MEASUREMENT
2025-08-08 18:22:04,003 - INFO - 
Mapping measurement_concept_id...

================================================================================
COMPREHENSIVE DATA PROCESSING MODULE
================================================================================
Start time: 2025-08-08 18:21:13

Configuration:
  Input directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning
  Output directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping
  Processed mappings: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/pipeline_modules/3_mapping/mapping_frequency/processed_mappings

Features enabled:
  Low frequency filtering: ≤10
  Date standardization: ENABLED
  Outlier removal (MEASUREMENT): 0.5% lower, 0.5% upper
  Deduplication: ENABLED
  Visit episode window: 2 hours

Tables to process: MEASUREMENT, OBSERVATION, PROCEDURE_OCCURRENCE, DEVICE_EXPOSURE, CONDITION_OCCURRENCE, CONDITION_ERA, DRUG_EXPOSURE, DRUG_ERA, VISIT_OCCURRENCE
================================================================================


Mapping measurement_concept_id:   0%|          | 0/1553188 [00:00<?, ?it/s]
Mapping measurement_concept_id:   7%|▋         | 113219/1553188 [00:00<00:01, 1132088.51it/s]
Mapping measurement_concept_id:  15%|█▌        | 233040/1553188 [00:00<00:01, 1170959.74it/s]
Mapping measurement_concept_id:  23%|██▎       | 350137/1553188 [00:00<00:01, 1081075.76it/s]
Mapping measurement_concept_id:  30%|██▉       | 458997/1553188 [00:00<00:01, 1021869.61it/s]
Mapping measurement_concept_id:  36%|███▌      | 561881/1553188 [00:00<00:00, 1014805.98it/s]
Mapping measurement_concept_id:  43%|████▎     | 663770/1553188 [00:00<00:00, 988820.55it/s] 
Mapping measurement_concept_id:  49%|████▉     | 763546/1553188 [00:00<00:00, 991547.02it/s]
Mapping measurement_concept_id:  56%|█████▌    | 862901/1553188 [00:00<00:00, 974003.48it/s]
Mapping measurement_concept_id:  62%|██████▏   | 960443/1553188 [00:00<00:00, 907194.99it/s]
Mapping measurement_concept_id:  68%|██████▊   | 1051955/1553188 [00:01<00:00, 849475.13it/s]
Mapping measurement_concept_id:  73%|███████▎  | 1137867/1553188 [00:01<00:00, 842968.25it/s]
Mapping measurement_concept_id:  79%|███████▉  | 1226075/1553188 [00:01<00:00, 853925.74it/s]
Mapping measurement_concept_id:  85%|████████▍ | 1316142/1553188 [00:01<00:00, 867283.76it/s]
Mapping measurement_concept_id:  94%|█████████▍| 1459985/1553188 [00:01<00:00, 1032992.42it/s]
Mapping measurement_concept_id: 100%|██████████| 1553188/1553188 [00:01<00:00, 997557.40it/s] 
2025-08-08 18:22:05,713 - INFO -   Total non-null values: 1,553,188
2025-08-08 18:22:05,713 - INFO -   Mapped values: 524,195 (33.7%)
2025-08-08 18:22:05,713 - INFO -   Unique concepts mapped: 418
2025-08-08 18:22:05,713 - INFO - 
Removing outliers (0.5% lower, 0.5% upper)...
2025-08-08 18:22:08,554 - INFO - 
Outlier removal statistics:
2025-08-08 18:22:08,555 - INFO -   Total outliers removed: 12217
2025-08-08 18:22:08,555 - INFO -   Concepts analyzed: 625
2025-08-08 18:22:08,556 - INFO -   Concept 3013429: 0 low, 24 high outliers
2025-08-08 18:22:08,556 - INFO -   Concept 3004249: 463 low, 475 high outliers
2025-08-08 18:22:08,556 - INFO -   Concept 3032080: 6 low, 7 high outliers
2025-08-08 18:22:08,556 - INFO -   Concept 3003137: 0 low, 1 high outliers
2025-08-08 18:22:08,556 - INFO -   Concept 3023599: 69 low, 66 high outliers
2025-08-08 18:22:08,812 - INFO -   Removed 12217 outliers
2025-08-08 18:22:08,812 - INFO - 
Performing deduplication...
2025-08-08 18:22:24,676 - INFO -   Duplicates found and removed: 4,869
2025-08-08 18:22:24,726 - INFO -   Saved duplicate records to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/removed_records/duplicates/MEASUREMENT.csv
2025-08-08 18:22:31,652 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/MEASUREMENT_mapped.csv
2025-08-08 18:22:31,653 - INFO - Final row count: 1,536,102
2025-08-08 18:22:32,228 - INFO - 
============================================================
2025-08-08 18:22:32,228 - INFO - Processing OBSERVATION
2025-08-08 18:22:32,228 - INFO - ============================================================
2025-08-08 18:22:32,775 - INFO - Loaded 204,833 rows
2025-08-08 18:22:32,775 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:32,837 - INFO -   Removed 1351 low frequency records
2025-08-08 18:22:32,837 - INFO - 
Standardizing dates...
2025-08-08 18:22:36,586 - INFO - Loaded 173 mappings for OBSERVATION
2025-08-08 18:22:36,586 - INFO - 
Mapping observation_concept_id...

Mapping observation_concept_id:   0%|          | 0/203482 [00:00<?, ?it/s]
Mapping observation_concept_id:  84%|████████▍ | 171623/203482 [00:00<00:00, 1716039.34it/s]
Mapping observation_concept_id: 100%|██████████| 203482/203482 [00:00<00:00, 1795654.00it/s]
2025-08-08 18:22:36,700 - INFO -   Total non-null values: 203,482
2025-08-08 18:22:36,700 - INFO -   Mapped values: 77 (0.0%)
2025-08-08 18:22:36,700 - INFO -   Unique concepts mapped: 3
2025-08-08 18:22:36,700 - INFO - 
Performing deduplication...
2025-08-08 18:22:36,944 - INFO -   Duplicates found and removed: 16
2025-08-08 18:22:36,945 - INFO -   Saved duplicate records to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/removed_records/duplicates/OBSERVATION.csv
2025-08-08 18:22:38,929 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/OBSERVATION_mapped.csv
2025-08-08 18:22:38,929 - INFO - Final row count: 203,466
2025-08-08 18:22:38,968 - INFO - 
============================================================
2025-08-08 18:22:38,968 - INFO - Processing PROCEDURE_OCCURRENCE
2025-08-08 18:22:38,968 - INFO - ============================================================
2025-08-08 18:22:39,095 - INFO - Loaded 46,067 rows
2025-08-08 18:22:39,095 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:39,139 - INFO -   Removed 6630 low frequency records
2025-08-08 18:22:39,139 - INFO - 
Standardizing dates...
2025-08-08 18:22:39,962 - INFO - Loaded 20378 mappings for PROCEDURE_OCCURRENCE
2025-08-08 18:22:39,962 - INFO - 
Mapping procedure_concept_id...

Mapping procedure_concept_id:   0%|          | 0/39437 [00:00<?, ?it/s]
Mapping procedure_concept_id: 100%|██████████| 39437/39437 [00:00<00:00, 1925799.46it/s]
2025-08-08 18:22:39,983 - INFO -   Total non-null values: 39,437
2025-08-08 18:22:39,983 - INFO -   Mapped values: 1,814 (4.6%)
2025-08-08 18:22:39,983 - INFO -   Unique concepts mapped: 59
2025-08-08 18:22:39,984 - INFO - 
Performing deduplication...
2025-08-08 18:22:40,036 - INFO -   Duplicates found and removed: 54
2025-08-08 18:22:40,037 - INFO -   Saved duplicate records to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/removed_records/duplicates/PROCEDURE_OCCURRENCE.csv
2025-08-08 18:22:40,189 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/PROCEDURE_OCCURRENCE_mapped.csv
2025-08-08 18:22:40,190 - INFO - Final row count: 39,383
2025-08-08 18:22:40,200 - INFO - 
============================================================
2025-08-08 18:22:40,200 - INFO - Processing DEVICE_EXPOSURE
2025-08-08 18:22:40,200 - INFO - ============================================================
2025-08-08 18:22:40,217 - INFO - Loaded 5,914 rows
2025-08-08 18:22:40,218 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:40,221 - INFO -   Removed 117 low frequency records
2025-08-08 18:22:40,221 - INFO - 
Standardizing dates...
2025-08-08 18:22:40,342 - INFO - Loaded 20 mappings for DEVICE_EXPOSURE
2025-08-08 18:22:40,342 - INFO - 
Mapping device_concept_id...

Mapping device_concept_id:   0%|          | 0/5797 [00:00<?, ?it/s]
Mapping device_concept_id: 100%|██████████| 5797/5797 [00:00<00:00, 2851457.76it/s]
2025-08-08 18:22:40,345 - INFO -   Total non-null values: 5,797
2025-08-08 18:22:40,345 - INFO -   Mapped values: 17 (0.3%)
2025-08-08 18:22:40,345 - INFO -   Unique concepts mapped: 1
2025-08-08 18:22:40,345 - INFO - 
Performing deduplication...
2025-08-08 18:22:40,349 - INFO -   Duplicates found and removed: 0
2025-08-08 18:22:40,369 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/DEVICE_EXPOSURE_mapped.csv
2025-08-08 18:22:40,370 - INFO - Final row count: 5,797
2025-08-08 18:22:40,371 - INFO - 
============================================================
2025-08-08 18:22:40,371 - INFO - Processing CONDITION_OCCURRENCE
2025-08-08 18:22:40,371 - INFO - ============================================================
2025-08-08 18:22:40,718 - INFO - Loaded 132,556 rows
2025-08-08 18:22:40,718 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:40,823 - INFO -   Removed 13606 low frequency records
2025-08-08 18:22:40,823 - INFO - 
Standardizing dates...
2025-08-08 18:22:44,755 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/CONDITION_OCCURRENCE_mapped.csv
2025-08-08 18:22:44,755 - INFO - Final row count: 118,950
2025-08-08 18:22:44,780 - INFO - 
============================================================
2025-08-08 18:22:44,780 - INFO - Processing CONDITION_ERA
2025-08-08 18:22:44,780 - INFO - ============================================================
2025-08-08 18:22:44,883 - INFO - Loaded 53,270 rows
2025-08-08 18:22:44,883 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:44,942 - INFO -   Removed 12187 low frequency records
2025-08-08 18:22:44,942 - INFO - 
Standardizing dates...
2025-08-08 18:22:45,639 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/CONDITION_ERA_mapped.csv
2025-08-08 18:22:45,639 - INFO - Final row count: 41,083
2025-08-08 18:22:45,647 - INFO - 
============================================================
2025-08-08 18:22:45,647 - INFO - Processing DRUG_EXPOSURE
2025-08-08 18:22:45,647 - INFO - ============================================================
2025-08-08 18:22:46,342 - INFO - Loaded 182,525 rows
2025-08-08 18:22:46,342 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:46,527 - INFO -   Removed 9440 low frequency records
2025-08-08 18:22:46,527 - INFO - 
Standardizing dates...
2025-08-08 18:22:53,490 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/DRUG_EXPOSURE_mapped.csv
2025-08-08 18:22:53,490 - INFO - Final row count: 173,085
2025-08-08 18:22:53,526 - INFO - 
============================================================
2025-08-08 18:22:53,527 - INFO - Processing DRUG_ERA
2025-08-08 18:22:53,527 - INFO - ============================================================
2025-08-08 18:22:53,584 - INFO - Loaded 31,335 rows
2025-08-08 18:22:53,584 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:53,599 - INFO -   Removed 2046 low frequency records
2025-08-08 18:22:53,600 - INFO - 
Standardizing dates...
2025-08-08 18:22:54,072 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/DRUG_ERA_mapped.csv
2025-08-08 18:22:54,072 - INFO - Final row count: 29,289
2025-08-08 18:22:54,076 - INFO - 
============================================================
2025-08-08 18:22:54,076 - INFO - Processing VISIT_OCCURRENCE
2025-08-08 18:22:54,076 - INFO - ============================================================
2025-08-08 18:22:54,151 - INFO - Loaded 25,425 rows
2025-08-08 18:22:54,151 - INFO - 
Filtering low frequency concepts (≤10)...
2025-08-08 18:22:54,158 - INFO -   Removed 25 low frequency records
2025-08-08 18:22:54,158 - INFO - 
Standardizing dates...
2025-08-08 18:22:55,354 - INFO - 
Saved processed data to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/VISIT_OCCURRENCE_mapped.csv
2025-08-08 18:22:55,354 - INFO - Final row count: 25,400
2025-08-08 18:22:55,358 - INFO - Report saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/mapping_report.md

================================================================================
PROCESSING COMPLETED SUCCESSFULLY
End time: 2025-08-08 18:22:55

Outputs saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping
Removed records saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/removed_records
================================================================================


============================================================
Module: Data Standardization
Start: 2025-08-08 18:22:55.385438
============================================================
2025-08-08 18:22:55,874 - INFO - Starting data standardization process...
2025-08-08 18:22:55,874 - INFO - Parameters: outlier_percentile=99.0, min_concept_frequency=10, merge_visits=True, merge_threshold=2.0h
2025-08-08 18:22:55,874 - INFO - 
============================================================
2025-08-08 18:22:55,874 - INFO - Processing table: MEASUREMENT
2025-08-08 18:22:55,874 - INFO - ============================================================
2025-08-08 18:22:55,874 - INFO - 
============================================================
2025-08-08 18:22:55,874 - INFO - Standardizing MEASUREMENT
2025-08-08 18:22:55,874 - INFO - ============================================================
2025-08-08 18:22:55,874 - INFO - Calculating concept statistics for MEASUREMENT

======================================================================
DATA STANDARDIZATION PROCESS - INPUT INFORMATION
======================================================================
Cleaning Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning
Mapping Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping
Output Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/4_standardization

Tables to standardize:
  - MEASUREMENT: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/MEASUREMENT_mapped.csv (from mapped)
  - OBSERVATION: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/OBSERVATION_mapped.csv (from mapped)
  - PROCEDURE_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/PROCEDURE_OCCURRENCE_mapped.csv (from mapped)
  - DEVICE_EXPOSURE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/3_mapping/DEVICE_EXPOSURE_mapped.csv (from mapped)
  - DRUG_EXPOSURE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DRUG_EXPOSURE_cleaned.csv (from cleaned)
  - VISIT_DETAIL: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_DETAIL_cleaned.csv (from cleaned)
  - VISIT_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_OCCURRENCE_cleaned.csv (from cleaned)
  - CONDITION_ERA: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/CONDITION_ERA_cleaned.csv (from cleaned)
  - CONDITION_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/CONDITION_OCCURRENCE_cleaned.csv (from cleaned)
  - DRUG_ERA: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/DRUG_ERA_cleaned.csv (from cleaned)
  - SPECIMEN: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/SPECIMEN_cleaned.csv (from cleaned)

Visit tables for merging:
  - VISIT_DETAIL: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_DETAIL_cleaned.csv
  - VISIT_OCCURRENCE: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning/VISIT_OCCURRENCE_cleaned.csv
======================================================================


Collecting statistics from MEASUREMENT: 0it [00:00, ?it/s]2025-08-08 18:22:56,001 - INFO - Column 'measurement_concept_id' found in MEASUREMENT
2025-08-08 18:22:56,001 - INFO - Sample values: [4030871, 3023368, 3013429, 3004249, 4120299]

Collecting statistics from MEASUREMENT: 1it [00:02,  2.02s/it]
Collecting statistics from MEASUREMENT: 2it [00:03,  1.95s/it]
Collecting statistics from MEASUREMENT: 3it [00:05,  1.96s/it]
Collecting statistics from MEASUREMENT: 4it [00:07,  1.95s/it]
Collecting statistics from MEASUREMENT: 5it [00:09,  2.03s/it]
Collecting statistics from MEASUREMENT: 6it [00:12,  2.14s/it]
Collecting statistics from MEASUREMENT: 7it [00:14,  2.18s/it]
Collecting statistics from MEASUREMENT: 8it [00:16,  2.21s/it]
Collecting statistics from MEASUREMENT: 9it [00:19,  2.25s/it]
Collecting statistics from MEASUREMENT: 10it [00:21,  2.29s/it]
Collecting statistics from MEASUREMENT: 11it [00:23,  2.20s/it]
Collecting statistics from MEASUREMENT: 12it [00:25,  2.15s/it]
Collecting statistics from MEASUREMENT: 13it [00:27,  2.10s/it]
Collecting statistics from MEASUREMENT: 14it [00:30,  2.21s/it]
Collecting statistics from MEASUREMENT: 15it [00:32,  2.18s/it]
Collecting statistics from MEASUREMENT: 16it [00:32,  1.75s/it]
Collecting statistics from MEASUREMENT: 16it [00:32,  2.06s/it]
2025-08-08 18:23:29,041 - INFO - Calculated thresholds for 623 concepts
2025-08-08 18:23:29,041 - INFO - Found 927 unique concepts in MEASUREMENT
2025-08-08 18:23:29,041 - INFO -   - 2 concepts have frequency < 10

Processing MEASUREMENT: 0it [00:00, ?it/s]
Processing MEASUREMENT: 3004it [00:00, 30033.73it/s]
Processing MEASUREMENT: 6008it [00:00, 28271.28it/s]
Processing MEASUREMENT: 9626it [00:00, 31763.42it/s]
Processing MEASUREMENT: 13230it [00:00, 33417.05it/s]
Processing MEASUREMENT: 16806it [00:00, 34248.29it/s]
Processing MEASUREMENT: 20410it [00:00, 34851.47it/s]
Processing MEASUREMENT: 24067it [00:00, 35409.77it/s]
Processing MEASUREMENT: 27619it [00:00, 35442.45it/s]
Processing MEASUREMENT: 31272it [00:00, 35778.83it/s]
Processing MEASUREMENT: 34914it [00:01, 35974.91it/s]
Processing MEASUREMENT: 38514it [00:01, 33253.06it/s]
Processing MEASUREMENT: 41881it [00:01, 33264.56it/s]
Processing MEASUREMENT: 45524it [00:01, 34181.42it/s]
Processing MEASUREMENT: 49099it [00:01, 34639.37it/s]
Processing MEASUREMENT: 52743it [00:01, 35168.44it/s]
Processing MEASUREMENT: 56274it [00:01, 35009.08it/s]
Processing MEASUREMENT: 59932it [00:01, 35473.61it/s]
Processing MEASUREMENT: 63487it [00:01, 35070.05it/s]
Processing MEASUREMENT: 67158it [00:01, 35554.39it/s]
Processing MEASUREMENT: 70854it [00:02, 35970.11it/s]
Processing MEASUREMENT: 74528it [00:02, 36198.78it/s]
Processing MEASUREMENT: 78155it [00:02, 36210.08it/s]
Processing MEASUREMENT: 81779it [00:02, 34596.19it/s]
Processing MEASUREMENT: 85349it [00:02, 34913.64it/s]
Processing MEASUREMENT: 89039it [00:02, 35493.20it/s]
Processing MEASUREMENT: 92682it [00:02, 35767.31it/s]
Processing MEASUREMENT: 96267it [00:02, 35656.83it/s]
Processing MEASUREMENT: 99921it [00:02, 35918.51it/s]
Processing MEASUREMENT: 103558it [00:02, 36050.96it/s]
Processing MEASUREMENT: 107252it [00:03, 36315.87it/s]
Processing MEASUREMENT: 110886it [00:03, 36109.12it/s]
Processing MEASUREMENT: 114499it [00:03, 34597.98it/s]
Processing MEASUREMENT: 117973it [00:03, 34326.24it/s]
Processing MEASUREMENT: 121495it [00:03, 34584.65it/s]
Processing MEASUREMENT: 124961it [00:03, 34218.50it/s]
Processing MEASUREMENT: 128389it [00:03, 33755.84it/s]
Processing MEASUREMENT: 132038it [00:03, 34548.54it/s]
Processing MEASUREMENT: 135498it [00:03, 33577.68it/s]
Processing MEASUREMENT: 139069it [00:04, 34193.54it/s]
Processing MEASUREMENT: 142497it [00:04, 32218.12it/s]
Processing MEASUREMENT: 145937it [00:04, 32833.96it/s]
Processing MEASUREMENT: 149516it [00:04, 33681.01it/s]
Processing MEASUREMENT: 152983it [00:04, 33967.23it/s]
Processing MEASUREMENT: 156590it [00:04, 34583.21it/s]
Processing MEASUREMENT: 160135it [00:04, 34836.68it/s]
Processing MEASUREMENT: 163627it [00:04, 34849.93it/s]
Processing MEASUREMENT: 167118it [00:04, 34806.06it/s]
Processing MEASUREMENT: 170745it [00:04, 35241.12it/s]
Processing MEASUREMENT: 174273it [00:05, 34317.50it/s]
Processing MEASUREMENT: 177827it [00:05, 34673.88it/s]
Processing MEASUREMENT: 181368it [00:05, 34888.66it/s]
Processing MEASUREMENT: 184889it [00:05, 34981.71it/s]
Processing MEASUREMENT: 188533it [00:05, 35413.49it/s]
Processing MEASUREMENT: 192180it [00:05, 35728.21it/s]
Processing MEASUREMENT: 195870it [00:05, 36077.10it/s]
Processing MEASUREMENT: 199480it [00:05, 35711.79it/s]
Processing MEASUREMENT: 203093it [00:05, 35834.64it/s]
Processing MEASUREMENT: 206790it [00:05, 36171.32it/s]
Processing MEASUREMENT: 210479it [00:06, 36384.01it/s]
Processing MEASUREMENT: 214167it [00:06, 36530.02it/s]
Processing MEASUREMENT: 217821it [00:06, 36195.33it/s]
Processing MEASUREMENT: 221442it [00:06, 36096.68it/s]
Processing MEASUREMENT: 225086it [00:06, 36197.40it/s]
Processing MEASUREMENT: 228707it [00:06, 36189.07it/s]
Processing MEASUREMENT: 232327it [00:06, 36114.68it/s]
Processing MEASUREMENT: 235939it [00:06, 36048.32it/s]
Processing MEASUREMENT: 239562it [00:06, 36101.29it/s]
Processing MEASUREMENT: 243173it [00:06, 36080.05it/s]
Processing MEASUREMENT: 246826it [00:07, 36212.19it/s]
Processing MEASUREMENT: 250448it [00:07, 36083.24it/s]
Processing MEASUREMENT: 254061it [00:07, 36096.14it/s]
Processing MEASUREMENT: 257671it [00:07, 36053.95it/s]
Processing MEASUREMENT: 261315it [00:07, 36168.71it/s]
Processing MEASUREMENT: 264932it [00:07, 36163.99it/s]
Processing MEASUREMENT: 268572it [00:07, 36232.97it/s]
Processing MEASUREMENT: 272236it [00:07, 36353.43it/s]
Processing MEASUREMENT: 275872it [00:07, 35979.94it/s]
Processing MEASUREMENT: 279496it [00:07, 36055.42it/s]
Processing MEASUREMENT: 283127it [00:08, 36130.84it/s]
Processing MEASUREMENT: 286742it [00:08, 36134.83it/s]
Processing MEASUREMENT: 290386it [00:08, 36223.63it/s]
Processing MEASUREMENT: 294009it [00:08, 36166.22it/s]
Processing MEASUREMENT: 297658it [00:08, 36260.82it/s]
Processing MEASUREMENT: 301302it [00:08, 36312.62it/s]
Processing MEASUREMENT: 304936it [00:08, 36318.76it/s]
Processing MEASUREMENT: 308568it [00:08, 36308.92it/s]
Processing MEASUREMENT: 312206it [00:08, 36327.51it/s]
Processing MEASUREMENT: 315839it [00:08, 36278.14it/s]
Processing MEASUREMENT: 319483it [00:09, 36324.02it/s]
Processing MEASUREMENT: 323120it [00:09, 36336.49it/s]
Processing MEASUREMENT: 326754it [00:09, 36235.30it/s]
Processing MEASUREMENT: 330378it [00:09, 36147.15it/s]
Processing MEASUREMENT: 334036it [00:09, 36275.48it/s]
Processing MEASUREMENT: 337664it [00:09, 31566.97it/s]
Processing MEASUREMENT: 341281it [00:09, 32813.70it/s]
Processing MEASUREMENT: 344861it [00:09, 33645.17it/s]
Processing MEASUREMENT: 348295it [00:09, 33324.52it/s]
Processing MEASUREMENT: 351885it [00:10, 34061.16it/s]
Processing MEASUREMENT: 355492it [00:10, 34641.80it/s]
Processing MEASUREMENT: 359057it [00:10, 34936.76it/s]
Processing MEASUREMENT: 362671it [00:10, 35291.55it/s]
Processing MEASUREMENT: 366297it [00:10, 35577.41it/s]
Processing MEASUREMENT: 369944it [00:10, 35842.48it/s]
Processing MEASUREMENT: 373571it [00:10, 35968.95it/s]
Processing MEASUREMENT: 377185it [00:10, 36019.09it/s]
Processing MEASUREMENT: 380819it [00:10, 36113.48it/s]
Processing MEASUREMENT: 384434it [00:10, 35955.52it/s]
Processing MEASUREMENT: 388032it [00:11, 35783.02it/s]
Processing MEASUREMENT: 391612it [00:11, 35681.35it/s]
Processing MEASUREMENT: 395182it [00:11, 35278.33it/s]
Processing MEASUREMENT: 398754it [00:11, 35407.74it/s]
Processing MEASUREMENT: 402411it [00:11, 35751.05it/s]
Processing MEASUREMENT: 406090it [00:11, 36058.17it/s]
Processing MEASUREMENT: 409697it [00:11, 34121.78it/s]
Processing MEASUREMENT: 413171it [00:11, 34298.40it/s]
Processing MEASUREMENT: 416764it [00:11, 34772.08it/s]
Processing MEASUREMENT: 420254it [00:11, 34138.04it/s]
Processing MEASUREMENT: 423804it [00:12, 34534.25it/s]
Processing MEASUREMENT: 427427it [00:12, 35031.95it/s]
Processing MEASUREMENT: 430938it [00:12, 34691.58it/s]
Processing MEASUREMENT: 434451it [00:12, 34819.94it/s]
Processing MEASUREMENT: 438028it [00:12, 35100.05it/s]
Processing MEASUREMENT: 441597it [00:12, 35273.34it/s]
Processing MEASUREMENT: 445127it [00:12, 34977.02it/s]
Processing MEASUREMENT: 448719it [00:12, 35255.13it/s]
Processing MEASUREMENT: 452323it [00:12, 35487.51it/s]
Processing MEASUREMENT: 455874it [00:12, 35008.15it/s]
Processing MEASUREMENT: 459388it [00:13, 35046.77it/s]
Processing MEASUREMENT: 462912it [00:13, 35103.59it/s]
Processing MEASUREMENT: 466424it [00:13, 30603.90it/s]
Processing MEASUREMENT: 469763it [00:13, 31357.13it/s]
Processing MEASUREMENT: 473273it [00:13, 32398.78it/s]
Processing MEASUREMENT: 476810it [00:13, 33242.70it/s]
Processing MEASUREMENT: 480194it [00:13, 33411.80it/s]
Processing MEASUREMENT: 483571it [00:13, 26056.55it/s]
Processing MEASUREMENT: 486447it [00:14, 24941.95it/s]
Processing MEASUREMENT: 489426it [00:14, 26134.04it/s]
Processing MEASUREMENT: 492833it [00:14, 28198.92it/s]
Processing MEASUREMENT: 496385it [00:14, 30182.63it/s]
Processing MEASUREMENT: 499840it [00:14, 31399.68it/s]
Processing MEASUREMENT: 503245it [00:14, 32152.99it/s]
Processing MEASUREMENT: 506530it [00:14, 28373.14it/s]
Processing MEASUREMENT: 509938it [00:14, 29890.89it/s]
Processing MEASUREMENT: 513499it [00:14, 31464.66it/s]
Processing MEASUREMENT: 516735it [00:14, 31542.82it/s]
Processing MEASUREMENT: 519990it [00:15, 31830.00it/s]
Processing MEASUREMENT: 523601it [00:15, 33069.71it/s]
Processing MEASUREMENT: 526944it [00:15, 32297.76it/s]
Processing MEASUREMENT: 530583it [00:15, 33481.94it/s]
Processing MEASUREMENT: 534183it [00:15, 34216.23it/s]
Processing MEASUREMENT: 537736it [00:15, 34602.60it/s]
Processing MEASUREMENT: 541210it [00:15, 34501.22it/s]
Processing MEASUREMENT: 544670it [00:15, 33194.20it/s]
Processing MEASUREMENT: 548364it [00:15, 34277.35it/s]
Processing MEASUREMENT: 552063it [00:16, 35066.05it/s]
Processing MEASUREMENT: 555583it [00:16, 34887.10it/s]
Processing MEASUREMENT: 559081it [00:16, 34243.23it/s]
Processing MEASUREMENT: 562608it [00:16, 34532.15it/s]
Processing MEASUREMENT: 566068it [00:16, 33318.40it/s]
Processing MEASUREMENT: 569412it [00:16, 32542.70it/s]
Processing MEASUREMENT: 572677it [00:16, 32340.96it/s]
Processing MEASUREMENT: 575918it [00:16, 31279.74it/s]
Processing MEASUREMENT: 579055it [00:16, 30890.62it/s]
Processing MEASUREMENT: 582367it [00:16, 31528.66it/s]
Processing MEASUREMENT: 585527it [00:17, 31247.29it/s]
Processing MEASUREMENT: 588657it [00:17, 28506.46it/s]
Processing MEASUREMENT: 591553it [00:17, 25132.44it/s]
Processing MEASUREMENT: 594157it [00:17, 18390.02it/s]
Processing MEASUREMENT: 596784it [00:17, 20043.26it/s]
Processing MEASUREMENT: 599829it [00:17, 22443.70it/s]
Processing MEASUREMENT: 603010it [00:17, 24762.22it/s]
Processing MEASUREMENT: 606067it [00:17, 26279.38it/s]
Processing MEASUREMENT: 608883it [00:18, 26652.33it/s]
Processing MEASUREMENT: 611683it [00:18, 24539.15it/s]
Processing MEASUREMENT: 614259it [00:18, 24846.30it/s]
Processing MEASUREMENT: 616833it [00:18, 24010.31it/s]
Processing MEASUREMENT: 620062it [00:18, 26271.02it/s]
Processing MEASUREMENT: 623200it [00:18, 27702.44it/s]
Processing MEASUREMENT: 626028it [00:18, 27389.50it/s]
Processing MEASUREMENT: 628807it [00:18, 26558.42it/s]
Processing MEASUREMENT: 631494it [00:18, 24059.84it/s]
Processing MEASUREMENT: 634763it [00:19, 26368.17it/s]
Processing MEASUREMENT: 637837it [00:19, 27575.28it/s]
Processing MEASUREMENT: 641023it [00:19, 28788.51it/s]
Processing MEASUREMENT: 644252it [00:19, 29796.56it/s]
Processing MEASUREMENT: 647339it [00:19, 30097.03it/s]
Processing MEASUREMENT: 650793it [00:19, 31402.71it/s]
Processing MEASUREMENT: 654427it [00:19, 32860.83it/s]
Processing MEASUREMENT: 658070it [00:19, 33918.80it/s]
Processing MEASUREMENT: 661679it [00:19, 34564.29it/s]
Processing MEASUREMENT: 665288it [00:19, 35017.50it/s]
Processing MEASUREMENT: 668881it [00:20, 35289.33it/s]
Processing MEASUREMENT: 672441it [00:20, 35380.92it/s]
Processing MEASUREMENT: 675983it [00:20, 35039.64it/s]
Processing MEASUREMENT: 679518it [00:20, 35131.07it/s]
Processing MEASUREMENT: 683110it [00:20, 35364.70it/s]
Processing MEASUREMENT: 686738it [00:20, 35634.97it/s]
Processing MEASUREMENT: 690354it [00:20, 35789.78it/s]
Processing MEASUREMENT: 693979it [00:20, 35926.44it/s]
Processing MEASUREMENT: 697613it [00:20, 36048.50it/s]
Processing MEASUREMENT: 701264it [00:21, 36182.88it/s]
Processing MEASUREMENT: 704883it [00:21, 35931.04it/s]
Processing MEASUREMENT: 708477it [00:21, 35537.06it/s]
Processing MEASUREMENT: 712139it [00:21, 35856.28it/s]
Processing MEASUREMENT: 715726it [00:21, 35523.30it/s]
Processing MEASUREMENT: 719280it [00:21, 31701.53it/s]
Processing MEASUREMENT: 722900it [00:21, 32933.71it/s]
Processing MEASUREMENT: 726560it [00:21, 33962.98it/s]
Processing MEASUREMENT: 730215it [00:21, 34703.59it/s]
Processing MEASUREMENT: 733785it [00:21, 34992.60it/s]
Processing MEASUREMENT: 737441it [00:22, 35449.99it/s]
Processing MEASUREMENT: 741072it [00:22, 35701.11it/s]
Processing MEASUREMENT: 744694it [00:22, 35853.77it/s]
Processing MEASUREMENT: 748291it [00:22, 35128.01it/s]
Processing MEASUREMENT: 751901it [00:22, 35412.19it/s]
Processing MEASUREMENT: 755551it [00:22, 35733.23it/s]
Processing MEASUREMENT: 759210it [00:22, 35986.70it/s]
Processing MEASUREMENT: 762814it [00:22, 35998.70it/s]
Processing MEASUREMENT: 766480it [00:22, 36193.29it/s]
Processing MEASUREMENT: 770118it [00:22, 36248.21it/s]
Processing MEASUREMENT: 773760it [00:23, 36297.97it/s]
Processing MEASUREMENT: 777391it [00:23, 36269.21it/s]
Processing MEASUREMENT: 781019it [00:23, 36169.01it/s]
Processing MEASUREMENT: 784637it [00:23, 35934.40it/s]
Processing MEASUREMENT: 788232it [00:23, 34768.17it/s]
Processing MEASUREMENT: 791717it [00:23, 34320.19it/s]
Processing MEASUREMENT: 795155it [00:23, 33755.83it/s]
Processing MEASUREMENT: 798563it [00:23, 33849.44it/s]
Processing MEASUREMENT: 802014it [00:23, 34040.68it/s]
Processing MEASUREMENT: 805557it [00:23, 34448.41it/s]
Processing MEASUREMENT: 809116it [00:24, 34784.60it/s]
Processing MEASUREMENT: 812641it [00:24, 34922.78it/s]
Processing MEASUREMENT: 816181it [00:24, 35062.60it/s]
Processing MEASUREMENT: 819689it [00:24, 34288.84it/s]
Processing MEASUREMENT: 823123it [00:24, 34224.51it/s]
Processing MEASUREMENT: 826582it [00:24, 34329.93it/s]
Processing MEASUREMENT: 830082it [00:24, 34528.05it/s]
Processing MEASUREMENT: 833613it [00:24, 34759.79it/s]
Processing MEASUREMENT: 837150it [00:24, 34941.38it/s]
Processing MEASUREMENT: 840706it [00:24, 35125.05it/s]
Processing MEASUREMENT: 844306it [00:25, 35386.53it/s]
Processing MEASUREMENT: 847887it [00:25, 35510.89it/s]
Processing MEASUREMENT: 851507it [00:25, 35714.36it/s]
Processing MEASUREMENT: 855079it [00:25, 35631.04it/s]
Processing MEASUREMENT: 858717it [00:25, 35852.30it/s]
Processing MEASUREMENT: 862352it [00:25, 36000.93it/s]
Processing MEASUREMENT: 866002it [00:25, 36147.64it/s]
Processing MEASUREMENT: 869617it [00:25, 36131.14it/s]
Processing MEASUREMENT: 873239it [00:25, 36157.26it/s]
Processing MEASUREMENT: 876855it [00:25, 35964.76it/s]
Processing MEASUREMENT: 880452it [00:26, 30032.76it/s]
Processing MEASUREMENT: 883787it [00:26, 30902.12it/s]
Processing MEASUREMENT: 887300it [00:26, 32054.25it/s]
Processing MEASUREMENT: 890606it [00:26, 31332.55it/s]
Processing MEASUREMENT: 894219it [00:26, 32671.88it/s]
Processing MEASUREMENT: 897799it [00:26, 33562.33it/s]
Processing MEASUREMENT: 901412it [00:26, 34303.40it/s]
Processing MEASUREMENT: 905021it [00:26, 34823.93it/s]
Processing MEASUREMENT: 908643it [00:26, 35234.48it/s]
Processing MEASUREMENT: 912186it [00:27, 35258.68it/s]
Processing MEASUREMENT: 915824it [00:27, 35590.06it/s]
Processing MEASUREMENT: 919411it [00:27, 35671.81it/s]
Processing MEASUREMENT: 922985it [00:27, 35665.65it/s]
Processing MEASUREMENT: 926557it [00:27, 34554.83it/s]
Processing MEASUREMENT: 930024it [00:27, 34135.60it/s]
Processing MEASUREMENT: 933447it [00:27, 34161.77it/s]
Processing MEASUREMENT: 936968it [00:27, 34468.70it/s]
Processing MEASUREMENT: 940457it [00:27, 34590.63it/s]
Processing MEASUREMENT: 943920it [00:27, 34523.97it/s]
Processing MEASUREMENT: 947375it [00:28, 34430.63it/s]
Processing MEASUREMENT: 950820it [00:28, 33966.32it/s]
Processing MEASUREMENT: 954219it [00:28, 32719.42it/s]
Processing MEASUREMENT: 957559it [00:28, 32914.92it/s]
Processing MEASUREMENT: 960859it [00:28, 32482.89it/s]
Processing MEASUREMENT: 964258it [00:28, 32921.27it/s]
Processing MEASUREMENT: 967763it [00:28, 33545.54it/s]
Processing MEASUREMENT: 971292it [00:28, 34060.91it/s]
Processing MEASUREMENT: 974745it [00:28, 34199.83it/s]
Processing MEASUREMENT: 978210it [00:29, 34332.52it/s]
Processing MEASUREMENT: 981646it [00:29, 33306.80it/s]
Processing MEASUREMENT: 985092it [00:29, 33643.66it/s]
Processing MEASUREMENT: 988525it [00:29, 33843.47it/s]
Processing MEASUREMENT: 991970it [00:29, 34022.79it/s]
Processing MEASUREMENT: 995376it [00:29, 33827.49it/s]
Processing MEASUREMENT: 998762it [00:29, 33790.39it/s]
Processing MEASUREMENT: 1002303it [00:29, 34270.23it/s]
Processing MEASUREMENT: 1005846it [00:29, 34614.48it/s]
Processing MEASUREMENT: 1009309it [00:29, 34509.74it/s]
Processing MEASUREMENT: 1012761it [00:30, 34481.38it/s]
Processing MEASUREMENT: 1016210it [00:30, 34351.09it/s]
Processing MEASUREMENT: 1019646it [00:30, 33673.07it/s]
Processing MEASUREMENT: 1023211it [00:30, 34253.54it/s]
Processing MEASUREMENT: 1026696it [00:30, 34429.50it/s]
Processing MEASUREMENT: 1030142it [00:30, 34161.08it/s]
Processing MEASUREMENT: 1033561it [00:30, 33675.60it/s]
Processing MEASUREMENT: 1036935it [00:30, 33692.16it/s]
Processing MEASUREMENT: 1040306it [00:30, 33664.66it/s]
Processing MEASUREMENT: 1043824it [00:30, 34113.88it/s]
Processing MEASUREMENT: 1047237it [00:31, 34042.43it/s]
Processing MEASUREMENT: 1050696it [00:31, 34203.30it/s]
Processing MEASUREMENT: 1054118it [00:31, 33086.62it/s]
Processing MEASUREMENT: 1057643it [00:31, 33715.90it/s]
Processing MEASUREMENT: 1061094it [00:31, 33947.08it/s]
Processing MEASUREMENT: 1064495it [00:31, 33938.39it/s]
Processing MEASUREMENT: 1067955it [00:31, 34133.00it/s]
Processing MEASUREMENT: 1071372it [00:31, 33942.38it/s]
Processing MEASUREMENT: 1074827it [00:31, 34122.60it/s]
Processing MEASUREMENT: 1078241it [00:32, 29577.21it/s]
Processing MEASUREMENT: 1081307it [00:32, 24176.17it/s]
Processing MEASUREMENT: 1083944it [00:32, 23656.75it/s]
Processing MEASUREMENT: 1086458it [00:32, 22532.90it/s]
Processing MEASUREMENT: 1088986it [00:32, 23212.48it/s]
Processing MEASUREMENT: 1091843it [00:32, 24611.52it/s]
Processing MEASUREMENT: 1094793it [00:32, 25938.87it/s]
Processing MEASUREMENT: 1097596it [00:32, 26516.06it/s]
Processing MEASUREMENT: 1100301it [00:32, 25579.72it/s]
Processing MEASUREMENT: 1102974it [00:33, 25902.20it/s]
Processing MEASUREMENT: 1105596it [00:33, 24399.34it/s]
Processing MEASUREMENT: 1108072it [00:33, 23541.31it/s]
Processing MEASUREMENT: 1110453it [00:33, 23493.84it/s]
Processing MEASUREMENT: 1112994it [00:33, 24032.87it/s]
Processing MEASUREMENT: 1115898it [00:33, 25468.44it/s]
Processing MEASUREMENT: 1118810it [00:33, 26528.69it/s]
Processing MEASUREMENT: 1121808it [00:33, 27540.81it/s]
Processing MEASUREMENT: 1124705it [00:33, 27960.65it/s]
Processing MEASUREMENT: 1127512it [00:34, 27703.32it/s]
Processing MEASUREMENT: 1130835it [00:34, 29335.13it/s]
Processing MEASUREMENT: 1133777it [00:34, 27799.43it/s]
Processing MEASUREMENT: 1136578it [00:34, 24331.11it/s]
Processing MEASUREMENT: 1139097it [00:34, 24044.38it/s]
Processing MEASUREMENT: 1142184it [00:34, 25879.67it/s]
Processing MEASUREMENT: 1144834it [00:34, 24149.27it/s]
Processing MEASUREMENT: 1147865it [00:34, 25805.56it/s]
Processing MEASUREMENT: 1150566it [00:34, 26089.93it/s]
Processing MEASUREMENT: 1153735it [00:35, 27675.80it/s]
Processing MEASUREMENT: 1156550it [00:35, 27811.60it/s]
Processing MEASUREMENT: 1159685it [00:35, 28841.73it/s]
Processing MEASUREMENT: 1162966it [00:35, 30007.48it/s]
Processing MEASUREMENT: 1166088it [00:35, 30364.77it/s]
Processing MEASUREMENT: 1169138it [00:35, 30130.51it/s]
Processing MEASUREMENT: 1172172it [00:35, 30190.92it/s]
Processing MEASUREMENT: 1175391it [00:35, 30783.68it/s]
Processing MEASUREMENT: 1178767it [00:35, 31668.05it/s]
Processing MEASUREMENT: 1181939it [00:35, 31385.19it/s]
Processing MEASUREMENT: 1185082it [00:36, 30551.88it/s]
Processing MEASUREMENT: 1188472it [00:36, 31529.24it/s]
Processing MEASUREMENT: 1191633it [00:36, 30375.70it/s]
Processing MEASUREMENT: 1194684it [00:36, 30123.94it/s]
Processing MEASUREMENT: 1197705it [00:36, 25742.44it/s]
Processing MEASUREMENT: 1200578it [00:36, 26521.70it/s]
Processing MEASUREMENT: 1203700it [00:36, 27796.00it/s]
Processing MEASUREMENT: 1207024it [00:36, 29317.11it/s]
Processing MEASUREMENT: 1210388it [00:36, 30550.17it/s]
Processing MEASUREMENT: 1213790it [00:36, 31553.01it/s]
Processing MEASUREMENT: 1217210it [00:37, 32325.22it/s]
Processing MEASUREMENT: 1220472it [00:37, 32097.77it/s]
Processing MEASUREMENT: 1223703it [00:37, 28673.05it/s]
Processing MEASUREMENT: 1226651it [00:37, 28358.33it/s]
Processing MEASUREMENT: 1229869it [00:37, 29414.62it/s]
Processing MEASUREMENT: 1232970it [00:37, 29860.77it/s]
Processing MEASUREMENT: 1235992it [00:37, 28870.27it/s]
Processing MEASUREMENT: 1238909it [00:37, 27236.63it/s]
Processing MEASUREMENT: 1241667it [00:38, 24101.56it/s]
Processing MEASUREMENT: 1244155it [00:38, 18552.39it/s]
Processing MEASUREMENT: 1246239it [00:38, 19053.82it/s]
Processing MEASUREMENT: 1248971it [00:38, 21027.76it/s]
Processing MEASUREMENT: 1251517it [00:38, 22154.79it/s]
Processing MEASUREMENT: 1254684it [00:38, 24689.82it/s]
Processing MEASUREMENT: 1257934it [00:38, 26842.20it/s]
Processing MEASUREMENT: 1260729it [00:38, 23437.85it/s]
Processing MEASUREMENT: 1263223it [00:39, 22671.10it/s]
Processing MEASUREMENT: 1266470it [00:39, 25216.22it/s]
Processing MEASUREMENT: 1269829it [00:39, 27482.89it/s]
Processing MEASUREMENT: 1273074it [00:39, 28867.53it/s]
Processing MEASUREMENT: 1276081it [00:39, 29203.41it/s]
Processing MEASUREMENT: 1279380it [00:39, 30296.42it/s]
Processing MEASUREMENT: 1282456it [00:39, 29711.40it/s]
Processing MEASUREMENT: 1285461it [00:39, 28536.05it/s]
Processing MEASUREMENT: 1288773it [00:39, 29836.25it/s]
Processing MEASUREMENT: 1291870it [00:39, 30161.86it/s]
Processing MEASUREMENT: 1294953it [00:40, 30355.05it/s]
Processing MEASUREMENT: 1298146it [00:40, 30816.48it/s]
Processing MEASUREMENT: 1301240it [00:40, 30594.21it/s]
Processing MEASUREMENT: 1304535it [00:40, 31288.53it/s]
Processing MEASUREMENT: 1307856it [00:40, 31857.74it/s]
Processing MEASUREMENT: 1311048it [00:40, 30384.95it/s]
Processing MEASUREMENT: 1314366it [00:40, 31189.73it/s]
Processing MEASUREMENT: 1317705it [00:40, 31828.26it/s]
Processing MEASUREMENT: 1320901it [00:40, 31810.51it/s]
Processing MEASUREMENT: 1324091it [00:40, 31521.41it/s]
Processing MEASUREMENT: 1327460it [00:41, 32158.99it/s]
Processing MEASUREMENT: 1330682it [00:41, 31615.61it/s]
Processing MEASUREMENT: 1333849it [00:41, 31093.07it/s]
Processing MEASUREMENT: 1336964it [00:41, 31099.50it/s]
Processing MEASUREMENT: 1340078it [00:41, 30465.84it/s]
Processing MEASUREMENT: 1343318it [00:41, 31029.66it/s]
Processing MEASUREMENT: 1346453it [00:41, 31123.23it/s]
Processing MEASUREMENT: 1349569it [00:41, 30179.24it/s]
Processing MEASUREMENT: 1352595it [00:41, 30047.20it/s]
Processing MEASUREMENT: 1355826it [00:42, 30707.70it/s]
Processing MEASUREMENT: 1358973it [00:42, 30931.71it/s]
Processing MEASUREMENT: 1362071it [00:42, 30759.34it/s]
Processing MEASUREMENT: 1365184it [00:42, 30867.69it/s]
Processing MEASUREMENT: 1368397it [00:42, 31242.67it/s]
Processing MEASUREMENT: 1371524it [00:42, 28943.28it/s]
Processing MEASUREMENT: 1374453it [00:42, 27609.82it/s]
Processing MEASUREMENT: 1377932it [00:42, 29602.22it/s]
Processing MEASUREMENT: 1381296it [00:42, 30746.86it/s]
Processing MEASUREMENT: 1384625it [00:42, 31479.99it/s]
Processing MEASUREMENT: 1387800it [00:43, 30804.20it/s]
Processing MEASUREMENT: 1390970it [00:43, 31061.14it/s]
Processing MEASUREMENT: 1394156it [00:43, 31291.61it/s]
Processing MEASUREMENT: 1397616it [00:43, 32264.49it/s]
Processing MEASUREMENT: 1401120it [00:43, 33084.14it/s]
Processing MEASUREMENT: 1404669it [00:43, 33796.73it/s]
Processing MEASUREMENT: 1408055it [00:43, 29518.68it/s]
Processing MEASUREMENT: 1411489it [00:43, 30824.32it/s]
Processing MEASUREMENT: 1414903it [00:43, 31749.06it/s]
Processing MEASUREMENT: 1418353it [00:44, 32531.53it/s]
Processing MEASUREMENT: 1421854it [00:44, 33246.39it/s]
Processing MEASUREMENT: 1425217it [00:44, 33303.35it/s]
Processing MEASUREMENT: 1428576it [00:44, 33386.07it/s]
Processing MEASUREMENT: 1432068it [00:44, 33838.21it/s]
Processing MEASUREMENT: 1435492it [00:44, 33955.99it/s]
Processing MEASUREMENT: 1438898it [00:44, 28691.94it/s]
Processing MEASUREMENT: 1442204it [00:44, 29844.96it/s]
Processing MEASUREMENT: 1445556it [00:44, 30849.96it/s]
Processing MEASUREMENT: 1448733it [00:44, 30238.13it/s]
Processing MEASUREMENT: 1452003it [00:45, 30929.31it/s]
Processing MEASUREMENT: 1455530it [00:45, 32171.59it/s]
Processing MEASUREMENT: 1459060it [00:45, 33077.62it/s]
Processing MEASUREMENT: 1462576it [00:45, 33686.53it/s]
Processing MEASUREMENT: 1466021it [00:45, 33908.80it/s]
Processing MEASUREMENT: 1469537it [00:45, 34277.42it/s]
Processing MEASUREMENT: 1473088it [00:45, 34643.20it/s]
Processing MEASUREMENT: 1476642it [00:45, 34905.69it/s]
Processing MEASUREMENT: 1480176it [00:45, 35033.26it/s]
Processing MEASUREMENT: 1483729it [00:45, 35168.04it/s]
Processing MEASUREMENT: 1487276it [00:46, 35256.95it/s]
Processing MEASUREMENT: 1490804it [00:46, 35041.36it/s]
Processing MEASUREMENT: 1494310it [00:46, 34836.79it/s]
Processing MEASUREMENT: 1497899it [00:46, 35148.51it/s]
Processing MEASUREMENT: 1501436it [00:46, 35212.91it/s]
Processing MEASUREMENT: 1505008it [00:46, 35362.21it/s]
Processing MEASUREMENT: 1508588it [00:46, 35490.73it/s]
Processing MEASUREMENT: 1512143it [00:46, 35506.99it/s]
Processing MEASUREMENT: 1515695it [00:47, 23937.56it/s]
Processing MEASUREMENT: 1519051it [00:47, 26091.72it/s]
Processing MEASUREMENT: 1522556it [00:47, 28262.01it/s]
Processing MEASUREMENT: 1526079it [00:47, 30053.38it/s]
Processing MEASUREMENT: 1529629it [00:47, 31515.85it/s]
Processing MEASUREMENT: 1532989it [00:47, 31759.33it/s]
Processing MEASUREMENT: 1536102it [00:47, 32213.32it/s]
2025-08-08 18:24:16,758 - INFO - 
Standardization Summary for MEASUREMENT:
2025-08-08 18:24:16,758 - INFO -   - Input records: 1,536,102
2025-08-08 18:24:16,758 - INFO -   - Output records: 1,445,907
2025-08-08 18:24:16,758 - INFO -   - Records removed: 90,195
2025-08-08 18:24:16,758 - INFO -     - Low frequency concepts: 18
2025-08-08 18:24:16,758 - INFO -     - Percentile outliers: 84,634
2025-08-08 18:24:16,758 - INFO -     - Range outliers: 5,543
2025-08-08 18:24:16,758 - INFO -   - Datetime fields standardized: 1,536,084
2025-08-08 18:24:16,758 - INFO -   - Units converted: 126,377
2025-08-08 18:24:16,758 - INFO - 
============================================================
2025-08-08 18:24:16,758 - INFO - Processing table: OBSERVATION
2025-08-08 18:24:16,758 - INFO - ============================================================
2025-08-08 18:24:16,758 - INFO - 
============================================================
2025-08-08 18:24:16,758 - INFO - Standardizing OBSERVATION
2025-08-08 18:24:16,758 - INFO - ============================================================
2025-08-08 18:24:16,759 - INFO - Calculating concept statistics for OBSERVATION

Collecting statistics from OBSERVATION: 0it [00:00, ?it/s]2025-08-08 18:24:16,864 - INFO - Column 'observation_concept_id' found in OBSERVATION
2025-08-08 18:24:16,865 - INFO - Sample values: [44816618, 4337265, 4129438, 4203722, 42529377]

Collecting statistics from OBSERVATION: 1it [00:00,  7.93it/s]
Collecting statistics from OBSERVATION: 2it [00:00,  8.31it/s]
Collecting statistics from OBSERVATION: 3it [00:00, 11.99it/s]
2025-08-08 18:24:17,011 - INFO - Found 314 unique concepts in OBSERVATION
2025-08-08 18:24:17,011 - INFO -   - 0 concepts have frequency < 10

Processing OBSERVATION: 0it [00:00, ?it/s]
Processing OBSERVATION: 4167it [00:00, 41666.96it/s]
Processing OBSERVATION: 8334it [00:00, 40648.53it/s]
Processing OBSERVATION: 12401it [00:00, 40632.78it/s]
Processing OBSERVATION: 16466it [00:00, 39083.74it/s]
Processing OBSERVATION: 20460it [00:00, 39382.10it/s]
Processing OBSERVATION: 24457it [00:00, 39577.68it/s]
Processing OBSERVATION: 28420it [00:00, 39466.31it/s]
Processing OBSERVATION: 32477it [00:00, 39811.71it/s]
Processing OBSERVATION: 36541it [00:00, 40065.71it/s]
Processing OBSERVATION: 40550it [00:01, 39791.11it/s]
Processing OBSERVATION: 44656it [00:01, 40172.86it/s]
Processing OBSERVATION: 48684it [00:01, 40204.16it/s]
Processing OBSERVATION: 52706it [00:01, 40163.75it/s]
Processing OBSERVATION: 56788it [00:01, 40359.03it/s]
Processing OBSERVATION: 60878it [00:01, 40518.58it/s]
Processing OBSERVATION: 64931it [00:01, 40150.65it/s]
Processing OBSERVATION: 68976it [00:01, 40236.88it/s]
Processing OBSERVATION: 73076it [00:01, 40463.58it/s]
Processing OBSERVATION: 77134it [00:01, 40497.53it/s]
Processing OBSERVATION: 81220it [00:02, 40603.40it/s]
Processing OBSERVATION: 85333it [00:02, 40758.73it/s]
Processing OBSERVATION: 89410it [00:02, 40702.35it/s]
Processing OBSERVATION: 93481it [00:02, 40679.82it/s]
Processing OBSERVATION: 97550it [00:02, 40662.53it/s]
Processing OBSERVATION: 101626it [00:02, 40689.91it/s]
Processing OBSERVATION: 105696it [00:02, 40246.54it/s]
Processing OBSERVATION: 109756it [00:02, 40350.61it/s]
Processing OBSERVATION: 113832it [00:02, 40470.14it/s]
Processing OBSERVATION: 117912it [00:02, 40566.38it/s]
Processing OBSERVATION: 121970it [00:03, 40510.09it/s]
Processing OBSERVATION: 126022it [00:03, 39634.14it/s]
Processing OBSERVATION: 129990it [00:03, 37668.92it/s]
Processing OBSERVATION: 133778it [00:03, 37222.42it/s]
Processing OBSERVATION: 137759it [00:03, 37964.35it/s]
Processing OBSERVATION: 141668it [00:03, 38289.76it/s]
Processing OBSERVATION: 145621it [00:03, 38652.79it/s]
Processing OBSERVATION: 149620it [00:03, 39047.39it/s]
Processing OBSERVATION: 153610it [00:03, 39297.38it/s]
Processing OBSERVATION: 157634it [00:03, 39576.04it/s]
Processing OBSERVATION: 161596it [00:04, 34599.91it/s]
Processing OBSERVATION: 165568it [00:04, 35988.09it/s]
Processing OBSERVATION: 169562it [00:04, 37091.15it/s]
Processing OBSERVATION: 173536it [00:04, 37845.83it/s]
Processing OBSERVATION: 177530it [00:04, 38451.64it/s]
Processing OBSERVATION: 181426it [00:04, 38599.56it/s]
Processing OBSERVATION: 185436it [00:04, 39040.46it/s]
Processing OBSERVATION: 189439it [00:04, 39331.82it/s]
Processing OBSERVATION: 193416it [00:04, 39459.55it/s]
Processing OBSERVATION: 197373it [00:05, 39336.15it/s]
Processing OBSERVATION: 201338it [00:05, 39427.63it/s]
Processing OBSERVATION: 203466it [00:05, 39428.99it/s]
2025-08-08 18:24:22,219 - INFO - 
Standardization Summary for OBSERVATION:
2025-08-08 18:24:22,219 - INFO -   - Input records: 203,466
2025-08-08 18:24:22,219 - INFO -   - Output records: 203,466
2025-08-08 18:24:22,219 - INFO -   - Records removed: 0
2025-08-08 18:24:22,219 - INFO -     - Low frequency concepts: 0
2025-08-08 18:24:22,219 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:22,219 - INFO -     - Range outliers: 0
2025-08-08 18:24:22,219 - INFO -   - Datetime fields standardized: 203,466
2025-08-08 18:24:22,219 - INFO -   - Units converted: 0
2025-08-08 18:24:22,220 - INFO - 
============================================================
2025-08-08 18:24:22,220 - INFO - Processing table: PROCEDURE_OCCURRENCE
2025-08-08 18:24:22,220 - INFO - ============================================================
2025-08-08 18:24:22,220 - INFO - 
============================================================
2025-08-08 18:24:22,220 - INFO - Standardizing PROCEDURE_OCCURRENCE
2025-08-08 18:24:22,220 - INFO - ============================================================
2025-08-08 18:24:22,220 - INFO - Calculating concept statistics for PROCEDURE_OCCURRENCE

Collecting statistics from PROCEDURE_OCCURRENCE: 0it [00:00, ?it/s]2025-08-08 18:24:22,256 - INFO - Column 'procedure_concept_id' found in PROCEDURE_OCCURRENCE
2025-08-08 18:24:22,256 - INFO - Sample values: [4304092, 4163872, 2414398, 4163872, 2109792]

Collecting statistics from PROCEDURE_OCCURRENCE: 1it [00:00, 23.00it/s]
2025-08-08 18:24:22,265 - INFO - Found 518 unique concepts in PROCEDURE_OCCURRENCE
2025-08-08 18:24:22,265 - INFO -   - 0 concepts have frequency < 10

Processing PROCEDURE_OCCURRENCE: 0it [00:00, ?it/s]
Processing PROCEDURE_OCCURRENCE: 3816it [00:00, 38156.85it/s]
Processing PROCEDURE_OCCURRENCE: 7759it [00:00, 38903.85it/s]
Processing PROCEDURE_OCCURRENCE: 11849it [00:00, 39812.41it/s]
Processing PROCEDURE_OCCURRENCE: 15845it [00:00, 39865.96it/s]
Processing PROCEDURE_OCCURRENCE: 19906it [00:00, 40130.45it/s]
Processing PROCEDURE_OCCURRENCE: 24026it [00:00, 40493.50it/s]
Processing PROCEDURE_OCCURRENCE: 28115it [00:00, 40622.59it/s]
Processing PROCEDURE_OCCURRENCE: 32224it [00:00, 40768.54it/s]
Processing PROCEDURE_OCCURRENCE: 36322it [00:00, 40833.34it/s]
Processing PROCEDURE_OCCURRENCE: 39383it [00:00, 40402.23it/s]
2025-08-08 18:24:23,248 - INFO - 
Standardization Summary for PROCEDURE_OCCURRENCE:
2025-08-08 18:24:23,248 - INFO -   - Input records: 39,383
2025-08-08 18:24:23,248 - INFO -   - Output records: 39,383
2025-08-08 18:24:23,248 - INFO -   - Records removed: 0
2025-08-08 18:24:23,248 - INFO -     - Low frequency concepts: 0
2025-08-08 18:24:23,248 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:23,248 - INFO -     - Range outliers: 0
2025-08-08 18:24:23,248 - INFO -   - Datetime fields standardized: 39,383
2025-08-08 18:24:23,248 - INFO -   - Units converted: 0
2025-08-08 18:24:23,249 - INFO - 
============================================================
2025-08-08 18:24:23,249 - INFO - Processing table: DEVICE_EXPOSURE
2025-08-08 18:24:23,249 - INFO - ============================================================
2025-08-08 18:24:23,249 - INFO - 
============================================================
2025-08-08 18:24:23,249 - INFO - Standardizing DEVICE_EXPOSURE
2025-08-08 18:24:23,249 - INFO - ============================================================
2025-08-08 18:24:23,249 - INFO - Calculating concept statistics for DEVICE_EXPOSURE

Collecting statistics from DEVICE_EXPOSURE: 0it [00:00, ?it/s]2025-08-08 18:24:23,257 - INFO - Column 'device_concept_id' found in DEVICE_EXPOSURE
2025-08-08 18:24:23,258 - INFO - Sample values: [40481859, 40481859, 40481859, 40481859, 40481859]

Collecting statistics from DEVICE_EXPOSURE: 1it [00:00, 115.01it/s]
2025-08-08 18:24:23,259 - INFO - Found 22 unique concepts in DEVICE_EXPOSURE
2025-08-08 18:24:23,259 - INFO -   - 0 concepts have frequency < 10

Processing DEVICE_EXPOSURE: 0it [00:00, ?it/s]
Processing DEVICE_EXPOSURE: 4067it [00:00, 40660.25it/s]
Processing DEVICE_EXPOSURE: 5797it [00:00, 40262.00it/s]
2025-08-08 18:24:23,408 - INFO - 
Standardization Summary for DEVICE_EXPOSURE:
2025-08-08 18:24:23,408 - INFO -   - Input records: 5,797
2025-08-08 18:24:23,408 - INFO -   - Output records: 5,797
2025-08-08 18:24:23,408 - INFO -   - Records removed: 0
2025-08-08 18:24:23,408 - INFO -     - Low frequency concepts: 0
2025-08-08 18:24:23,408 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:23,408 - INFO -     - Range outliers: 0
2025-08-08 18:24:23,408 - INFO -   - Datetime fields standardized: 5,797
2025-08-08 18:24:23,408 - INFO -   - Units converted: 0
2025-08-08 18:24:23,408 - INFO - 
============================================================
2025-08-08 18:24:23,408 - INFO - Processing table: DRUG_EXPOSURE
2025-08-08 18:24:23,408 - INFO - ============================================================
2025-08-08 18:24:23,408 - INFO - 
============================================================
2025-08-08 18:24:23,408 - INFO - Standardizing DRUG_EXPOSURE
2025-08-08 18:24:23,408 - INFO - ============================================================
2025-08-08 18:24:23,408 - INFO - Calculating concept statistics for DRUG_EXPOSURE

Collecting statistics from DRUG_EXPOSURE: 0it [00:00, ?it/s]2025-08-08 18:24:23,543 - INFO - Column 'drug_concept_id' found in DRUG_EXPOSURE
2025-08-08 18:24:23,543 - INFO - Sample values: [40213146, 40213146, 19134047, 42799312, 35603238]

Collecting statistics from DRUG_EXPOSURE: 1it [00:00,  6.43it/s]
Collecting statistics from DRUG_EXPOSURE: 2it [00:00,  7.21it/s]
Collecting statistics from DRUG_EXPOSURE: 2it [00:00,  7.08it/s]
2025-08-08 18:24:23,692 - INFO - Found 4383 unique concepts in DRUG_EXPOSURE
2025-08-08 18:24:23,692 - INFO -   - 2910 concepts have frequency < 10

Processing DRUG_EXPOSURE: 0it [00:00, ?it/s]
Processing DRUG_EXPOSURE: 2898it [00:00, 28971.32it/s]
Processing DRUG_EXPOSURE: 5796it [00:00, 27620.29it/s]
Processing DRUG_EXPOSURE: 8759it [00:00, 28512.14it/s]
Processing DRUG_EXPOSURE: 11791it [00:00, 29212.98it/s]
Processing DRUG_EXPOSURE: 14717it [00:00, 27760.66it/s]
Processing DRUG_EXPOSURE: 17507it [00:00, 26167.75it/s]
Processing DRUG_EXPOSURE: 20144it [00:00, 24438.53it/s]
Processing DRUG_EXPOSURE: 22614it [00:00, 24080.19it/s]
Processing DRUG_EXPOSURE: 25038it [00:00, 23234.63it/s]
Processing DRUG_EXPOSURE: 27373it [00:01, 23137.03it/s]
Processing DRUG_EXPOSURE: 29694it [00:01, 22422.94it/s]
Processing DRUG_EXPOSURE: 31943it [00:01, 22406.57it/s]
Processing DRUG_EXPOSURE: 34311it [00:01, 22772.63it/s]
Processing DRUG_EXPOSURE: 36593it [00:01, 22780.35it/s]
Processing DRUG_EXPOSURE: 38875it [00:01, 22090.99it/s]
Processing DRUG_EXPOSURE: 41438it [00:01, 23113.76it/s]
Processing DRUG_EXPOSURE: 43874it [00:01, 23475.74it/s]
Processing DRUG_EXPOSURE: 46229it [00:02, 18207.93it/s]
Processing DRUG_EXPOSURE: 48272it [00:02, 18753.81it/s]
Processing DRUG_EXPOSURE: 50319it [00:02, 19197.99it/s]
Processing DRUG_EXPOSURE: 52628it [00:02, 20250.65it/s]
Processing DRUG_EXPOSURE: 54873it [00:02, 20863.25it/s]
Processing DRUG_EXPOSURE: 57133it [00:02, 21357.71it/s]
Processing DRUG_EXPOSURE: 59592it [00:02, 22289.96it/s]
Processing DRUG_EXPOSURE: 61919it [00:02, 22573.83it/s]
Processing DRUG_EXPOSURE: 64238it [00:02, 22752.27it/s]
Processing DRUG_EXPOSURE: 66532it [00:02, 22772.26it/s]
Processing DRUG_EXPOSURE: 68988it [00:03, 23300.70it/s]
Processing DRUG_EXPOSURE: 71350it [00:03, 23393.87it/s]
Processing DRUG_EXPOSURE: 73697it [00:03, 23202.03it/s]
Processing DRUG_EXPOSURE: 76023it [00:03, 23012.22it/s]
Processing DRUG_EXPOSURE: 78516it [00:03, 23576.37it/s]
Processing DRUG_EXPOSURE: 80878it [00:03, 23381.02it/s]
Processing DRUG_EXPOSURE: 84010it [00:03, 25729.03it/s]
Processing DRUG_EXPOSURE: 86588it [00:03, 25048.17it/s]
Processing DRUG_EXPOSURE: 89100it [00:03, 24297.09it/s]
Processing DRUG_EXPOSURE: 91538it [00:03, 23739.89it/s]
Processing DRUG_EXPOSURE: 93922it [00:04, 23766.89it/s]
Processing DRUG_EXPOSURE: 96304it [00:04, 22932.99it/s]
Processing DRUG_EXPOSURE: 99067it [00:04, 24275.05it/s]
Processing DRUG_EXPOSURE: 101976it [00:04, 25670.42it/s]
Processing DRUG_EXPOSURE: 104921it [00:04, 26775.34it/s]
Processing DRUG_EXPOSURE: 107611it [00:04, 19201.09it/s]
Processing DRUG_EXPOSURE: 109838it [00:04, 19367.67it/s]
Processing DRUG_EXPOSURE: 111993it [00:04, 18515.34it/s]
Processing DRUG_EXPOSURE: 114034it [00:05, 18977.31it/s]
Processing DRUG_EXPOSURE: 116201it [00:05, 19673.75it/s]
Processing DRUG_EXPOSURE: 118515it [00:05, 20609.20it/s]
Processing DRUG_EXPOSURE: 120652it [00:05, 20731.25it/s]
Processing DRUG_EXPOSURE: 122779it [00:05, 19678.71it/s]
Processing DRUG_EXPOSURE: 124793it [00:05, 19550.87it/s]
Processing DRUG_EXPOSURE: 126780it [00:05, 19545.28it/s]
Processing DRUG_EXPOSURE: 129000it [00:05, 20298.88it/s]
Processing DRUG_EXPOSURE: 131105it [00:05, 20513.51it/s]
Processing DRUG_EXPOSURE: 134237it [00:05, 23672.71it/s]
Processing DRUG_EXPOSURE: 136923it [00:06, 24595.81it/s]
Processing DRUG_EXPOSURE: 139397it [00:06, 24573.16it/s]
Processing DRUG_EXPOSURE: 141865it [00:06, 23179.59it/s]
Processing DRUG_EXPOSURE: 144206it [00:06, 22449.25it/s]
Processing DRUG_EXPOSURE: 146469it [00:06, 21112.05it/s]
Processing DRUG_EXPOSURE: 148604it [00:06, 20793.41it/s]
Processing DRUG_EXPOSURE: 150745it [00:06, 20964.25it/s]
Processing DRUG_EXPOSURE: 152907it [00:06, 21150.03it/s]
Processing DRUG_EXPOSURE: 155032it [00:06, 20970.72it/s]
Processing DRUG_EXPOSURE: 157136it [00:07, 20772.76it/s]
Processing DRUG_EXPOSURE: 159250it [00:07, 20876.46it/s]
Processing DRUG_EXPOSURE: 161416it [00:07, 21105.18it/s]
Processing DRUG_EXPOSURE: 163530it [00:07, 20933.54it/s]
Processing DRUG_EXPOSURE: 165626it [00:07, 20631.77it/s]
Processing DRUG_EXPOSURE: 167692it [00:07, 20449.59it/s]
Processing DRUG_EXPOSURE: 169743it [00:07, 20464.67it/s]
Processing DRUG_EXPOSURE: 171803it [00:07, 20501.62it/s]
Processing DRUG_EXPOSURE: 173854it [00:07, 20252.24it/s]
Processing DRUG_EXPOSURE: 175881it [00:07, 19297.52it/s]
Processing DRUG_EXPOSURE: 177905it [00:08, 19567.39it/s]
Processing DRUG_EXPOSURE: 179876it [00:08, 19606.36it/s]
Processing DRUG_EXPOSURE: 181881it [00:08, 19736.19it/s]
Processing DRUG_EXPOSURE: 182525it [00:08, 21979.95it/s]
2025-08-08 18:24:32,013 - INFO - 
Standardization Summary for DRUG_EXPOSURE:
2025-08-08 18:24:32,013 - INFO -   - Input records: 182,525
2025-08-08 18:24:32,013 - INFO -   - Output records: 173,985
2025-08-08 18:24:32,013 - INFO -   - Records removed: 8,540
2025-08-08 18:24:32,013 - INFO -     - Low frequency concepts: 8,540
2025-08-08 18:24:32,013 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:32,014 - INFO -     - Range outliers: 0
2025-08-08 18:24:32,014 - INFO -   - Datetime fields standardized: 410,541
2025-08-08 18:24:32,014 - INFO -   - Units converted: 0
2025-08-08 18:24:32,014 - INFO - 
============================================================
2025-08-08 18:24:32,014 - INFO - Processing table: VISIT_DETAIL
2025-08-08 18:24:32,014 - INFO - ============================================================
2025-08-08 18:24:32,014 - INFO - 
============================================================
2025-08-08 18:24:32,014 - INFO - Standardizing VISIT_DETAIL
2025-08-08 18:24:32,014 - INFO - ============================================================
2025-08-08 18:24:32,014 - INFO - Calculating concept statistics for VISIT_DETAIL

Collecting statistics from VISIT_DETAIL: 0it [00:00, ?it/s]2025-08-08 18:24:32,055 - INFO - Column 'visit_detail_concept_id' found in VISIT_DETAIL
2025-08-08 18:24:32,055 - INFO - Sample values: [8717, 8717, 8717, 8717, 581379]

Collecting statistics from VISIT_DETAIL: 1it [00:00, 22.06it/s]
2025-08-08 18:24:32,061 - INFO - Found 20 unique concepts in VISIT_DETAIL
2025-08-08 18:24:32,061 - INFO -   - 4 concepts have frequency < 10

Processing VISIT_DETAIL: 0it [00:00, ?it/s]
Processing VISIT_DETAIL: 2286it [00:00, 22852.07it/s]
Processing VISIT_DETAIL: 4716it [00:00, 23698.50it/s]
Processing VISIT_DETAIL: 7116it [00:00, 23835.82it/s]
Processing VISIT_DETAIL: 9519it [00:00, 23910.00it/s]
Processing VISIT_DETAIL: 11911it [00:00, 22806.79it/s]
Processing VISIT_DETAIL: 14201it [00:00, 19145.96it/s]
Processing VISIT_DETAIL: 16598it [00:00, 20509.48it/s]
Processing VISIT_DETAIL: 19035it [00:00, 21618.90it/s]
Processing VISIT_DETAIL: 21468it [00:00, 22407.35it/s]
Processing VISIT_DETAIL: 23890it [00:01, 22938.71it/s]
Processing VISIT_DETAIL: 26222it [00:01, 22451.93it/s]
Processing VISIT_DETAIL: 26978it [00:01, 22228.96it/s]
2025-08-08 18:24:33,296 - INFO - 
Standardization Summary for VISIT_DETAIL:
2025-08-08 18:24:33,296 - INFO -   - Input records: 26,978
2025-08-08 18:24:33,296 - INFO -   - Output records: 26,971
2025-08-08 18:24:33,296 - INFO -   - Records removed: 7
2025-08-08 18:24:33,296 - INFO -     - Low frequency concepts: 7
2025-08-08 18:24:33,296 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:33,296 - INFO -     - Range outliers: 0
2025-08-08 18:24:33,296 - INFO -   - Datetime fields standardized: 53,942
2025-08-08 18:24:33,296 - INFO -   - Units converted: 0
2025-08-08 18:24:33,296 - INFO - 
============================================================
2025-08-08 18:24:33,296 - INFO - Processing table: VISIT_OCCURRENCE
2025-08-08 18:24:33,296 - INFO - ============================================================
2025-08-08 18:24:33,296 - INFO - 
============================================================
2025-08-08 18:24:33,296 - INFO - Standardizing VISIT_OCCURRENCE
2025-08-08 18:24:33,296 - INFO - ============================================================
2025-08-08 18:24:33,296 - INFO - Calculating concept statistics for VISIT_OCCURRENCE

Collecting statistics from VISIT_OCCURRENCE: 0it [00:00, ?it/s]2025-08-08 18:24:33,332 - INFO - Column 'visit_concept_id' found in VISIT_OCCURRENCE
2025-08-08 18:24:33,332 - INFO - Sample values: [9202, 9202, 9202, 9202, 9202]

Collecting statistics from VISIT_OCCURRENCE: 1it [00:00, 25.09it/s]
2025-08-08 18:24:33,338 - INFO - Found 23 unique concepts in VISIT_OCCURRENCE
2025-08-08 18:24:33,338 - INFO -   - 9 concepts have frequency < 10

Processing VISIT_OCCURRENCE: 0it [00:00, ?it/s]
Processing VISIT_OCCURRENCE: 2492it [00:00, 24913.01it/s]
Processing VISIT_OCCURRENCE: 4984it [00:00, 24151.20it/s]
Processing VISIT_OCCURRENCE: 7401it [00:00, 23852.77it/s]
Processing VISIT_OCCURRENCE: 9788it [00:00, 23729.01it/s]
Processing VISIT_OCCURRENCE: 12162it [00:00, 23221.52it/s]
Processing VISIT_OCCURRENCE: 14586it [00:00, 23558.29it/s]
Processing VISIT_OCCURRENCE: 17000it [00:00, 23743.40it/s]
Processing VISIT_OCCURRENCE: 19391it [00:00, 23795.33it/s]
Processing VISIT_OCCURRENCE: 21818it [00:00, 23941.30it/s]
Processing VISIT_OCCURRENCE: 24222it [00:01, 23968.94it/s]
Processing VISIT_OCCURRENCE: 25425it [00:01, 23837.23it/s]
2025-08-08 18:24:34,418 - INFO - 
Standardization Summary for VISIT_OCCURRENCE:
2025-08-08 18:24:34,418 - INFO -   - Input records: 25,425
2025-08-08 18:24:34,418 - INFO -   - Output records: 25,400
2025-08-08 18:24:34,418 - INFO -   - Records removed: 25
2025-08-08 18:24:34,418 - INFO -     - Low frequency concepts: 25
2025-08-08 18:24:34,418 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:34,418 - INFO -     - Range outliers: 0
2025-08-08 18:24:34,418 - INFO -   - Datetime fields standardized: 50,800
2025-08-08 18:24:34,418 - INFO -   - Units converted: 0
2025-08-08 18:24:34,418 - INFO - 
============================================================
2025-08-08 18:24:34,418 - INFO - Processing table: CONDITION_ERA
2025-08-08 18:24:34,418 - INFO - ============================================================
2025-08-08 18:24:34,418 - INFO - 
============================================================
2025-08-08 18:24:34,418 - INFO - Standardizing CONDITION_ERA
2025-08-08 18:24:34,418 - INFO - ============================================================
2025-08-08 18:24:34,418 - INFO - Calculating concept statistics for CONDITION_ERA

Collecting statistics from CONDITION_ERA: 0it [00:00, ?it/s]2025-08-08 18:24:34,449 - INFO - Column 'condition_concept_id' found in CONDITION_ERA
2025-08-08 18:24:34,449 - INFO - Sample values: [4000609, 4092879, 434610, 377091, 377091]

Collecting statistics from CONDITION_ERA: 1it [00:00, 24.46it/s]
2025-08-08 18:24:34,461 - INFO - Found 5484 unique concepts in CONDITION_ERA
2025-08-08 18:24:34,461 - INFO -   - 4346 concepts have frequency < 10

Processing CONDITION_ERA: 0it [00:00, ?it/s]
Processing CONDITION_ERA: 6111it [00:00, 61104.52it/s]
Processing CONDITION_ERA: 12222it [00:00, 59808.21it/s]
Processing CONDITION_ERA: 18357it [00:00, 60499.66it/s]
Processing CONDITION_ERA: 24621it [00:00, 61337.88it/s]
Processing CONDITION_ERA: 30757it [00:00, 60469.35it/s]
Processing CONDITION_ERA: 36807it [00:00, 59858.42it/s]
Processing CONDITION_ERA: 43107it [00:00, 60867.35it/s]
Processing CONDITION_ERA: 49549it [00:00, 61983.32it/s]
Processing CONDITION_ERA: 53270it [00:00, 61065.24it/s]
2025-08-08 18:24:35,335 - INFO - 
Standardization Summary for CONDITION_ERA:
2025-08-08 18:24:35,335 - INFO -   - Input records: 53,270
2025-08-08 18:24:35,335 - INFO -   - Output records: 41,863
2025-08-08 18:24:35,335 - INFO -   - Records removed: 11,407
2025-08-08 18:24:35,335 - INFO -     - Low frequency concepts: 11,407
2025-08-08 18:24:35,335 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:35,335 - INFO -     - Range outliers: 0
2025-08-08 18:24:35,335 - INFO -   - Datetime fields standardized: 0
2025-08-08 18:24:35,335 - INFO -   - Units converted: 0
2025-08-08 18:24:35,335 - INFO - 
============================================================
2025-08-08 18:24:35,336 - INFO - Processing table: CONDITION_OCCURRENCE
2025-08-08 18:24:35,336 - INFO - ============================================================
2025-08-08 18:24:35,336 - INFO - 
============================================================
2025-08-08 18:24:35,336 - INFO - Standardizing CONDITION_OCCURRENCE
2025-08-08 18:24:35,336 - INFO - ============================================================
2025-08-08 18:24:35,336 - INFO - Calculating concept statistics for CONDITION_OCCURRENCE

Collecting statistics from CONDITION_OCCURRENCE: 0it [00:00, ?it/s]2025-08-08 18:24:35,422 - INFO - Column 'condition_concept_id' found in CONDITION_OCCURRENCE
2025-08-08 18:24:35,422 - INFO - Sample values: [42539502, 4128369, 200054, 43530681, 438567]

Collecting statistics from CONDITION_OCCURRENCE: 1it [00:00,  9.37it/s]
Collecting statistics from CONDITION_OCCURRENCE: 2it [00:00, 13.25it/s]
2025-08-08 18:24:35,488 - INFO - Found 6276 unique concepts in CONDITION_OCCURRENCE
2025-08-08 18:24:35,489 - INFO -   - 4446 concepts have frequency < 10

Processing CONDITION_OCCURRENCE: 0it [00:00, ?it/s]
Processing CONDITION_OCCURRENCE: 2977it [00:00, 29762.65it/s]
Processing CONDITION_OCCURRENCE: 5954it [00:00, 29539.65it/s]
Processing CONDITION_OCCURRENCE: 8913it [00:00, 29561.92it/s]
Processing CONDITION_OCCURRENCE: 11870it [00:00, 29551.63it/s]
Processing CONDITION_OCCURRENCE: 14841it [00:00, 29607.21it/s]
Processing CONDITION_OCCURRENCE: 17815it [00:00, 29650.20it/s]
Processing CONDITION_OCCURRENCE: 20826it [00:00, 29797.07it/s]
Processing CONDITION_OCCURRENCE: 23806it [00:00, 29508.33it/s]
Processing CONDITION_OCCURRENCE: 26758it [00:00, 29341.00it/s]
Processing CONDITION_OCCURRENCE: 30036it [00:01, 30392.21it/s]
Processing CONDITION_OCCURRENCE: 34028it [00:01, 33288.29it/s]
Processing CONDITION_OCCURRENCE: 38149it [00:01, 35683.74it/s]
Processing CONDITION_OCCURRENCE: 42237it [00:01, 37251.23it/s]
Processing CONDITION_OCCURRENCE: 46238it [00:01, 38080.26it/s]
Processing CONDITION_OCCURRENCE: 50363it [00:01, 39033.13it/s]
Processing CONDITION_OCCURRENCE: 54268it [00:01, 38612.82it/s]
Processing CONDITION_OCCURRENCE: 58171it [00:01, 38736.20it/s]
Processing CONDITION_OCCURRENCE: 62381it [00:01, 39740.66it/s]
Processing CONDITION_OCCURRENCE: 66357it [00:01, 39235.73it/s]
Processing CONDITION_OCCURRENCE: 70521it [00:02, 39948.03it/s]
Processing CONDITION_OCCURRENCE: 74526it [00:02, 39975.41it/s]
Processing CONDITION_OCCURRENCE: 78526it [00:02, 37735.04it/s]
Processing CONDITION_OCCURRENCE: 82667it [00:02, 38788.00it/s]
Processing CONDITION_OCCURRENCE: 87129it [00:02, 40479.62it/s]
Processing CONDITION_OCCURRENCE: 91322it [00:02, 40903.92it/s]
Processing CONDITION_OCCURRENCE: 95429it [00:02, 39875.89it/s]
Processing CONDITION_OCCURRENCE: 99433it [00:02, 34158.92it/s]
Processing CONDITION_OCCURRENCE: 102996it [00:02, 31337.19it/s]
Processing CONDITION_OCCURRENCE: 106259it [00:03, 29711.41it/s]
Processing CONDITION_OCCURRENCE: 109321it [00:03, 26803.25it/s]
Processing CONDITION_OCCURRENCE: 112093it [00:03, 26460.96it/s]
Processing CONDITION_OCCURRENCE: 114798it [00:03, 26003.69it/s]
Processing CONDITION_OCCURRENCE: 117435it [00:03, 25796.97it/s]
Processing CONDITION_OCCURRENCE: 120042it [00:03, 25870.02it/s]
Processing CONDITION_OCCURRENCE: 122647it [00:03, 24908.45it/s]
Processing CONDITION_OCCURRENCE: 125266it [00:03, 25262.04it/s]
Processing CONDITION_OCCURRENCE: 128078it [00:03, 26071.63it/s]
Processing CONDITION_OCCURRENCE: 130816it [00:04, 26447.58it/s]
Processing CONDITION_OCCURRENCE: 132556it [00:04, 32212.18it/s]
2025-08-08 18:24:39,619 - INFO - 
Standardization Summary for CONDITION_OCCURRENCE:
2025-08-08 18:24:39,619 - INFO -   - Input records: 132,556
2025-08-08 18:24:39,619 - INFO -   - Output records: 119,950
2025-08-08 18:24:39,619 - INFO -   - Records removed: 12,606
2025-08-08 18:24:39,619 - INFO -     - Low frequency concepts: 12,606
2025-08-08 18:24:39,619 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:39,619 - INFO -     - Range outliers: 0
2025-08-08 18:24:39,619 - INFO -   - Datetime fields standardized: 186,136
2025-08-08 18:24:39,619 - INFO -   - Units converted: 0
2025-08-08 18:24:39,619 - INFO - 
============================================================
2025-08-08 18:24:39,619 - INFO - Processing table: DRUG_ERA
2025-08-08 18:24:39,619 - INFO - ============================================================
2025-08-08 18:24:39,619 - INFO - 
============================================================
2025-08-08 18:24:39,619 - INFO - Standardizing DRUG_ERA
2025-08-08 18:24:39,619 - INFO - ============================================================
2025-08-08 18:24:39,620 - INFO - Calculating concept statistics for DRUG_ERA

Collecting statistics from DRUG_ERA: 0it [00:00, ?it/s]2025-08-08 18:24:39,640 - INFO - Column 'drug_concept_id' found in DRUG_ERA
2025-08-08 18:24:39,640 - INFO - Sample values: [917006, 1506270, 1777806, 1506270, 1506270]

Collecting statistics from DRUG_ERA: 1it [00:00, 37.81it/s]
2025-08-08 18:24:39,647 - INFO - Found 975 unique concepts in DRUG_ERA
2025-08-08 18:24:39,647 - INFO -   - 548 concepts have frequency < 10

Processing DRUG_ERA: 0it [00:00, ?it/s]
Processing DRUG_ERA: 5535it [00:00, 55339.50it/s]
Processing DRUG_ERA: 11239it [00:00, 56334.45it/s]
Processing DRUG_ERA: 16873it [00:00, 56266.82it/s]
Processing DRUG_ERA: 22518it [00:00, 56335.76it/s]
Processing DRUG_ERA: 28152it [00:00, 56184.41it/s]
Processing DRUG_ERA: 31335it [00:00, 56218.60it/s]
2025-08-08 18:24:40,213 - INFO - 
Standardization Summary for DRUG_ERA:
2025-08-08 18:24:40,213 - INFO -   - Input records: 31,335
2025-08-08 18:24:40,213 - INFO -   - Output records: 29,499
2025-08-08 18:24:40,213 - INFO -   - Records removed: 1,836
2025-08-08 18:24:40,213 - INFO -     - Low frequency concepts: 1,836
2025-08-08 18:24:40,213 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:40,213 - INFO -     - Range outliers: 0
2025-08-08 18:24:40,213 - INFO -   - Datetime fields standardized: 0
2025-08-08 18:24:40,213 - INFO -   - Units converted: 0
2025-08-08 18:24:40,214 - INFO - 
============================================================
2025-08-08 18:24:40,214 - INFO - Processing table: SPECIMEN
2025-08-08 18:24:40,214 - INFO - ============================================================
2025-08-08 18:24:40,214 - INFO - 
============================================================
2025-08-08 18:24:40,214 - INFO - Standardizing SPECIMEN
2025-08-08 18:24:40,214 - INFO - ============================================================
2025-08-08 18:24:40,214 - INFO - Calculating concept statistics for SPECIMEN

Collecting statistics from SPECIMEN: 0it [00:00, ?it/s]2025-08-08 18:24:40,218 - INFO - Column 'specimen_concept_id' found in SPECIMEN
2025-08-08 18:24:40,219 - INFO - Sample values: [4001225, 4001225, 4001225, 4001225, 4001225]

Collecting statistics from SPECIMEN: 1it [00:00, 210.14it/s]
2025-08-08 18:24:40,220 - INFO - Found 29 unique concepts in SPECIMEN
2025-08-08 18:24:40,220 - INFO -   - 15 concepts have frequency < 10

Processing SPECIMEN: 0it [00:00, ?it/s]
Processing SPECIMEN: 2422it [00:00, 24217.08it/s]
Processing SPECIMEN: 3874it [00:00, 28778.58it/s]
2025-08-08 18:24:40,357 - INFO - 
Standardization Summary for SPECIMEN:
2025-08-08 18:24:40,357 - INFO -   - Input records: 3,874
2025-08-08 18:24:40,357 - INFO -   - Output records: 3,833
2025-08-08 18:24:40,357 - INFO -   - Records removed: 41
2025-08-08 18:24:40,357 - INFO -     - Low frequency concepts: 41
2025-08-08 18:24:40,357 - INFO -     - Percentile outliers: 0
2025-08-08 18:24:40,357 - INFO -     - Range outliers: 0
2025-08-08 18:24:40,357 - INFO -   - Datetime fields standardized: 3,833
2025-08-08 18:24:40,357 - INFO -   - Units converted: 0
2025-08-08 18:24:40,357 - INFO - 
Merging close visits in VISIT_DETAIL
2025-08-08 18:24:40,357 - INFO - Skipping merge for VISIT_DETAIL - already processed in standardization
2025-08-08 18:24:40,357 - INFO - 
Merging close visits in VISIT_OCCURRENCE
2025-08-08 18:24:40,357 - INFO - Skipping merge for VISIT_OCCURRENCE - already processed in standardization
2025-08-08 18:24:40,361 - INFO - Generated removal summary
2025-08-08 18:24:40,361 - INFO - Report saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/4_standardization/standardization_report.md
2025-08-08 18:24:40,362 - INFO - Standardization process completed!

======================================================================
DATA STANDARDIZATION PROCESS - SUMMARY
======================================================================

Tables Modified:
  - MEASUREMENT
  - DRUG_EXPOSURE
  - VISIT_DETAIL
  - VISIT_OCCURRENCE
  - CONDITION_ERA
  - CONDITION_OCCURRENCE
  - DRUG_ERA
  - SPECIMEN

Total Records:
  - Input: 2,240,711
  - Output: 2,116,054
  - Removed: 124,657 (5.6%)

Records Removed by Type:
  - Low frequency concepts: 34,480
  - Outliers: 90,177

Visit Merging:
  - Visits merged: 0

Output Files Created:
  Standardized data:
    - MEASUREMENT_standardized.csv
    - OBSERVATION_standardized.csv
    - PROCEDURE_OCCURRENCE_standardized.csv
    - DEVICE_EXPOSURE_standardized.csv
    - DRUG_EXPOSURE_standardized.csv
    - VISIT_DETAIL_standardized.csv
    - VISIT_OCCURRENCE_standardized.csv
    - CONDITION_ERA_standardized.csv
    - CONDITION_OCCURRENCE_standardized.csv
    - DRUG_ERA_standardized.csv
    - SPECIMEN_standardized.csv

  Removed records:
    outliers_percentile:
      - MEASUREMENT_percentile_outliers.csv
    outliers_range:
      - MEASUREMENT_range_outliers.csv
    low_frequency:
      - VISIT_DETAIL_low_frequency.csv
      - DEVICE_EXPOSURE_low_frequency.csv
      - SPECIMEN_low_frequency.csv
      - DRUG_EXPOSURE_low_frequency.csv
      - MEASUREMENT_low_frequency.csv
      - DRUG_ERA_low_frequency.csv
      - PROCEDURE_OCCURRENCE_low_frequency.csv
      - CONDITION_ERA_low_frequency.csv
      - CONDITION_OCCURRENCE_low_frequency.csv
      - OBSERVATION_low_frequency.csv
      - VISIT_OCCURRENCE_low_frequency.csv

  Reports:
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/4_standardization/standardization_results.json
    - /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/4_standardization/standardization_report.md
======================================================================


============================================================
Module: ICU Data Extraction
Start: 2025-08-08 18:24:40.408018
============================================================
2025-08-08 18:24:40,781 - INFO - Step 1: Extracting ICU visit summaries...
2025-08-08 18:24:40,781 - INFO - Extracting ICU visit summaries...

======================================================================
PATIENT DATA EXTRACTION PROCESS
======================================================================
Standardized Data Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/4_standardization
Cleaning Data Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/2_cleaning
Output Directory: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/5_extraction

Standardized tables to process: MEASUREMENT, OBSERVATION, DRUG_EXPOSURE, CONDITION_OCCURRENCE, VISIT_OCCURRENCE, VISIT_DETAIL, PROCEDURE_OCCURRENCE, DEVICE_EXPOSURE, SPECIMEN, CONDITION_ERA, DRUG_ERA
Basic tables to process: PERSON, DEATH
ICU Concept IDs: 581379, 32037
======================================================================


======================================================================
STEP 1/4: Extracting ICU visit summaries
======================================================================

Extracting ICU visits:   0%|          | 0/1 [00:00<?, ?it/s]/Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/pipeline_modules/5_extraction/run_icu_extraction.py:105: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  icu_visits['visit_detail_start_datetime'] = pd.to_datetime(icu_visits['visit_detail_start_datetime'])
/Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/pipeline_modules/5_extraction/run_icu_extraction.py:106: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  icu_visits['visit_detail_end_datetime'] = pd.to_datetime(icu_visits['visit_detail_end_datetime'])

Extracting ICU visits: 100%|██████████| 1/1 [00:00<00:00,  2.99it/s]
Extracting ICU visits: 100%|██████████| 1/1 [00:00<00:00,  2.99it/s]
2025-08-08 18:24:41,128 - INFO - Extracted ICU summaries for 413 patients
2025-08-08 18:24:41,128 - INFO - 
Step 2: Splitting standardized tables by patient...
2025-08-08 18:24:41,128 - INFO - Processing MEASUREMENT...

======================================================================
STEP 2/4: Processing 11 standardized tables
======================================================================

[1/11] Processing MEASUREMENT...

Processing MEASUREMENT:   0%|          | 0/15 [00:00<?, ?chunks/s]/Users/aaron_luo/opt/anaconda3/envs/am205/lib/python3.8/site-packages/tqdm/std.py:1178: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  for obj in iterable:

Processing MEASUREMENT:   7%|▋         | 1/15 [00:00<00:09,  1.52chunks/s]
Processing MEASUREMENT:  13%|█▎        | 2/15 [00:01<00:08,  1.49chunks/s]/Users/aaron_luo/opt/anaconda3/envs/am205/lib/python3.8/site-packages/tqdm/std.py:1178: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  for obj in iterable:

Processing MEASUREMENT:  20%|██        | 3/15 [00:02<00:08,  1.48chunks/s]
Processing MEASUREMENT:  27%|██▋       | 4/15 [00:02<00:08,  1.37chunks/s]
Processing MEASUREMENT:  33%|███▎      | 5/15 [00:03<00:07,  1.43chunks/s]
Processing MEASUREMENT:  40%|████      | 6/15 [00:04<00:06,  1.46chunks/s]
Processing MEASUREMENT:  47%|████▋     | 7/15 [00:04<00:05,  1.45chunks/s]/Users/aaron_luo/opt/anaconda3/envs/am205/lib/python3.8/site-packages/tqdm/std.py:1178: DtypeWarning: Columns (4) have mixed types. Specify dtype option on import or set low_memory=False.
  for obj in iterable:

Processing MEASUREMENT:  53%|█████▎    | 8/15 [00:05<00:04,  1.42chunks/s]
Processing MEASUREMENT:  60%|██████    | 9/15 [00:06<00:04,  1.40chunks/s]
Processing MEASUREMENT:  67%|██████▋   | 10/15 [00:07<00:03,  1.41chunks/s]
Processing MEASUREMENT:  73%|███████▎  | 11/15 [00:07<00:02,  1.43chunks/s]
Processing MEASUREMENT:  80%|████████  | 12/15 [00:08<00:02,  1.43chunks/s]
Processing MEASUREMENT:  87%|████████▋ | 13/15 [00:09<00:01,  1.43chunks/s]
Processing MEASUREMENT:  93%|█████████▎| 14/15 [00:09<00:00,  1.43chunks/s]
Processing MEASUREMENT: 100%|██████████| 15/15 [00:10<00:00,  1.69chunks/s]
Processing MEASUREMENT: 100%|██████████| 15/15 [00:10<00:00,  1.48chunks/s]
2025-08-08 18:24:51,556 - INFO - Processed 1,445,907 records for 537 patients in MEASUREMENT
2025-08-08 18:24:51,558 - INFO - Processing OBSERVATION...

[2/11] Processing OBSERVATION...

Processing OBSERVATION:   0%|          | 0/3 [00:00<?, ?chunks/s]
Processing OBSERVATION:  33%|███▎      | 1/3 [00:00<00:01,  1.73chunks/s]
Processing OBSERVATION:  67%|██████▋   | 2/3 [00:01<00:00,  1.53chunks/s]
Processing OBSERVATION: 100%|██████████| 3/3 [00:01<00:00,  2.28chunks/s]
2025-08-08 18:24:52,913 - INFO - Processed 203,466 records for 523 patients in OBSERVATION
2025-08-08 18:24:52,913 - INFO - Processing DRUG_EXPOSURE...

[3/11] Processing DRUG_EXPOSURE...

Processing DRUG_EXPOSURE:   0%|          | 0/2 [00:00<?, ?chunks/s]
Processing DRUG_EXPOSURE:  50%|█████     | 1/2 [00:00<00:00,  1.22chunks/s]
Processing DRUG_EXPOSURE: 100%|██████████| 2/2 [00:01<00:00,  1.36chunks/s]
Processing DRUG_EXPOSURE: 100%|██████████| 2/2 [00:01<00:00,  1.33chunks/s]
2025-08-08 18:24:54,458 - INFO - Processed 173,985 records for 532 patients in DRUG_EXPOSURE
2025-08-08 18:24:54,462 - INFO - Processing CONDITION_OCCURRENCE...

[4/11] Processing CONDITION_OCCURRENCE...

Processing CONDITION_OCCURRENCE:   0%|          | 0/2 [00:00<?, ?chunks/s]
Processing CONDITION_OCCURRENCE:  50%|█████     | 1/2 [00:00<00:00,  1.46chunks/s]
Processing CONDITION_OCCURRENCE: 100%|██████████| 2/2 [00:00<00:00,  2.49chunks/s]
Processing CONDITION_OCCURRENCE: 100%|██████████| 2/2 [00:00<00:00,  2.25chunks/s]
2025-08-08 18:24:55,378 - INFO - Processed 119,950 records for 527 patients in CONDITION_OCCURRENCE
2025-08-08 18:24:55,379 - INFO - Processing VISIT_OCCURRENCE...

[5/11] Processing VISIT_OCCURRENCE...

Processing VISIT_OCCURRENCE:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing VISIT_OCCURRENCE: 100%|██████████| 1/1 [00:00<00:00,  2.64chunks/s]
Processing VISIT_OCCURRENCE: 100%|██████████| 1/1 [00:00<00:00,  2.64chunks/s]
2025-08-08 18:24:55,768 - INFO - Processed 25,400 records for 538 patients in VISIT_OCCURRENCE
2025-08-08 18:24:55,769 - INFO - Processing VISIT_DETAIL...

[6/11] Processing VISIT_DETAIL...

Processing VISIT_DETAIL:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing VISIT_DETAIL: 100%|██████████| 1/1 [00:00<00:00,  2.10chunks/s]
Processing VISIT_DETAIL: 100%|██████████| 1/1 [00:00<00:00,  2.10chunks/s]
2025-08-08 18:24:56,254 - INFO - Processed 26,971 records for 537 patients in VISIT_DETAIL
2025-08-08 18:24:56,257 - INFO - Processing PROCEDURE_OCCURRENCE...

[7/11] Processing PROCEDURE_OCCURRENCE...

Processing PROCEDURE_OCCURRENCE:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing PROCEDURE_OCCURRENCE: 100%|██████████| 1/1 [00:00<00:00,  2.31chunks/s]
Processing PROCEDURE_OCCURRENCE: 100%|██████████| 1/1 [00:00<00:00,  2.31chunks/s]
2025-08-08 18:24:56,701 - INFO - Processed 39,383 records for 520 patients in PROCEDURE_OCCURRENCE
2025-08-08 18:24:56,703 - INFO - Processing DEVICE_EXPOSURE...

[8/11] Processing DEVICE_EXPOSURE...

Processing DEVICE_EXPOSURE:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing DEVICE_EXPOSURE: 100%|██████████| 1/1 [00:00<00:00,  9.31chunks/s]
Processing DEVICE_EXPOSURE: 100%|██████████| 1/1 [00:00<00:00,  9.30chunks/s]
2025-08-08 18:24:56,814 - INFO - Processed 5,797 records for 204 patients in DEVICE_EXPOSURE
2025-08-08 18:24:56,815 - INFO - Processing SPECIMEN...

[9/11] Processing SPECIMEN...

Processing SPECIMEN:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing SPECIMEN: 100%|██████████| 1/1 [00:00<00:00, 15.72chunks/s]
2025-08-08 18:24:56,881 - INFO - Processed 3,833 records for 141 patients in SPECIMEN
2025-08-08 18:24:56,881 - INFO - Processing CONDITION_ERA...

[10/11] Processing CONDITION_ERA...

Processing CONDITION_ERA:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing CONDITION_ERA: 100%|██████████| 1/1 [00:00<00:00,  4.20chunks/s]
Processing CONDITION_ERA: 100%|██████████| 1/1 [00:00<00:00,  4.19chunks/s]
2025-08-08 18:24:57,127 - INFO - Processed 41,863 records for 354 patients in CONDITION_ERA
2025-08-08 18:24:57,128 - INFO - Processing DRUG_ERA...

[11/11] Processing DRUG_ERA...

Processing DRUG_ERA:   0%|          | 0/1 [00:00<?, ?chunks/s]
Processing DRUG_ERA: 100%|██████████| 1/1 [00:00<00:00,  4.51chunks/s]
Processing DRUG_ERA: 100%|██████████| 1/1 [00:00<00:00,  4.50chunks/s]
2025-08-08 18:24:57,357 - INFO - Processed 29,499 records for 364 patients in DRUG_ERA
2025-08-08 18:24:57,358 - INFO - 
Step 3: Processing basic tables...
2025-08-08 18:24:57,358 - INFO - Processing PERSON from cleaning directory...

======================================================================
STEP 3/4: Processing 2 basic tables
======================================================================

[1/2] Processing PERSON...

Processing PERSON:   0%|          | 0/538 [00:00<?, ?patients/s]
Processing PERSON:  38%|███▊      | 207/538 [00:00<00:00, 2064.38patients/s]
Processing PERSON:  77%|███████▋  | 414/538 [00:00<00:00, 1974.68patients/s]
Processing PERSON: 100%|██████████| 538/538 [00:00<00:00, 2182.86patients/s]
2025-08-08 18:24:57,610 - INFO - Processed 538 records for 538 patients in PERSON
2025-08-08 18:24:57,610 - INFO - Processing DEATH from cleaning directory...

[2/2] Processing DEATH...

Processing DEATH:   0%|          | 0/112 [00:00<?, ?patients/s]
Processing DEATH: 100%|██████████| 112/112 [00:00<00:00, 2659.45patients/s]
2025-08-08 18:24:57,655 - INFO - Processed 112 records for 112 patients in DEATH
2025-08-08 18:24:57,655 - INFO - 
Step 4: Calculating pre-ICU statistics...
2025-08-08 18:24:57,655 - INFO - Calculating pre-ICU statistics...

======================================================================
STEP 4/4: Calculating pre-ICU statistics
======================================================================

Calculating pre-ICU stats:   0%|          | 0/413 [00:00<?, ?patients/s]
Calculating pre-ICU stats:   8%|▊         | 35/413 [00:00<00:01, 348.25patients/s]
Calculating pre-ICU stats:  18%|█▊        | 75/413 [00:00<00:00, 375.28patients/s]
Calculating pre-ICU stats:  29%|██▉       | 121/413 [00:00<00:00, 411.48patients/s]
Calculating pre-ICU stats:  40%|███▉      | 165/413 [00:00<00:00, 420.84patients/s]
Calculating pre-ICU stats:  51%|█████▏    | 212/413 [00:00<00:00, 436.75patients/s]
Calculating pre-ICU stats:  67%|██████▋   | 275/413 [00:00<00:00, 501.96patients/s]
Calculating pre-ICU stats:  84%|████████▍ | 346/413 [00:00<00:00, 567.25patients/s]
Calculating pre-ICU stats: 100%|██████████| 413/413 [00:00<00:00, 522.44patients/s]
2025-08-08 18:24:58,447 - INFO - Pre-ICU statistics saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/5_extraction/statistics/patient_before_icu_statistics.csv
2025-08-08 18:24:58,447 - INFO - Report saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/5_extraction/extraction_report.md

======================================================================
EXTRACTION COMPLETE
======================================================================
Patient data saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/5_extraction/patient_data
Statistics saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/5_extraction/statistics
Report saved to: /Users/aaron_luo/2_Harvard_Lifes/3_Research/5_Critical/0_crisp-pipeline/crisp_pipeline_public/output/5_extraction/extraction_report.md
======================================================================
